# æ™ºè¯Šé€šRAGæ£€ç´¢å¢å¼ºç³»ç»Ÿå®Œæ•´è¯´æ˜æ–‡æ¡£

## ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°

æ™ºè¯Šé€šRAGï¼ˆRetrieval-Augmented Generationï¼‰æ£€ç´¢å¢å¼ºç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºå¤§è¯­è¨€æ¨¡å‹çš„æ™ºèƒ½åŒ»ç–—çŸ¥è¯†æ£€ç´¢å¹³å°ï¼Œé€šè¿‡å‘é‡æ£€ç´¢æŠ€æœ¯å¢å¼ºç”Ÿæˆè´¨é‡ï¼Œä¸ºåŒ»ç–—é¢†åŸŸæä¾›ç²¾å‡†ã€é«˜æ•ˆçš„æ™ºèƒ½é—®ç­”æœåŠ¡ã€‚

### ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- **æ™ºèƒ½æ£€ç´¢**ï¼šåŸºäºå‘é‡ç›¸ä¼¼åº¦çš„è¯­ä¹‰æœç´¢
- **å¤šæ¨¡æ€æ”¯æŒ**ï¼šæ–‡æœ¬ã€å›¾åƒã€è¯­éŸ³æ•°æ®çš„ç»Ÿä¸€å¤„ç†
- **è·¨æ¨¡æ€æ£€ç´¢**ï¼šå›¾åƒæŸ¥è¯¢è¿”å›ç›¸å…³æ–‡æœ¬ï¼Œæ–‡æœ¬æŸ¥è¯¢æ”¯æŒå›¾åƒç»“æœ
- **æ™ºèƒ½ç”Ÿæˆ**ï¼šåŸºäºMedical_Qwen3_17Bçš„åŒ»ç–—æ–‡æœ¬ç”Ÿæˆ
- **æµå¼è¾“å‡º**ï¼šæ”¯æŒå®æ—¶æµå¼å“åº”ï¼Œæä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ
- **å†…å®¹æ‘˜è¦**ï¼šè‡ªåŠ¨å°†æ£€ç´¢å†…å®¹æ‘˜è¦åˆ°50å­—ä»¥å†…ï¼Œæé«˜å¤„ç†æ•ˆç‡
- **ç”Ÿäº§å°±ç»ª**ï¼šå®Œæ•´çš„éƒ¨ç½²é…ç½®å’Œç›‘æ§ä½“ç³»
- **é«˜æ•ˆæ¶æ„**ï¼šæ¶ˆé™¤é‡å¤åŠŸèƒ½ï¼Œç»Ÿä¸€é…ç½®ç®¡ç†
- **ç»Ÿä¸€æ£€ç´¢**ï¼šæ”¯æŒæ–‡æœ¬ã€å›¾åƒã€æ··åˆæŸ¥è¯¢çš„ç»Ÿä¸€æ¥å£
- **å®¹é”™æœºåˆ¶**ï¼šç½‘ç»œé—®é¢˜è‡ªåŠ¨å¤„ç†ï¼ŒæœåŠ¡é«˜å¯ç”¨
- **é«˜æ•ˆå­˜å‚¨**ï¼šå•ä¸€æ•°æ®åº“æ¶æ„ï¼Œé¿å…æ•°æ®å†—ä½™

### ğŸ† ç³»ç»Ÿä¼˜åŠ¿

âœ… **ç»Ÿä¸€æ¶æ„**ï¼šè§£å†³äº†å¤šæ•°æ®åº“å†—ä½™é—®é¢˜  
âœ… **æ™ºèƒ½æ£€ç´¢**ï¼šæ”¯æŒæ–‡æœ¬ã€å›¾åƒã€æ··åˆæŸ¥è¯¢  
âœ… **å®¹é”™æœºåˆ¶**ï¼šç½‘ç»œé—®é¢˜è‡ªåŠ¨å¤„ç†  
âœ… **é«˜æ•ˆå­˜å‚¨**ï¼šå•ä¸€æ•°æ®åº“æ¶æ„  
âœ… **å®Œæ•´æµ‹è¯•**ï¼šæ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½éªŒè¯é€šè¿‡  
âœ… **ç”Ÿäº§å°±ç»ª**ï¼šå®Œæ•´çš„éƒ¨ç½²é…ç½®å’Œç›‘æ§ä½“ç³»

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ™ºè¯Šé€šRAGæ£€ç´¢å¢å¼ºç³»ç»Ÿ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‰ç«¯ç•Œé¢  â”‚  åç«¯API  â”‚  æ£€ç´¢æœåŠ¡  â”‚  å‘é‡åŒ–æœåŠ¡  â”‚  çŸ¥è¯†åº“æ„å»º  â”‚
â”‚  (Vue.js)  â”‚ (FastAPI) â”‚  (RAG)    â”‚ (Vectorization) â”‚ (Building) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    æ•°æ®å­˜å‚¨å±‚        â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                    â”‚  â”‚  å‘é‡æ•°æ®åº“     â”‚ â”‚
                    â”‚  â”‚  (FAISS)        â”‚ â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                    â”‚  â”‚  åŸå§‹æ•°æ®       â”‚ â”‚
                    â”‚  â”‚  (åŒ»ç–—æ–‡æ¡£)     â”‚ â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”„ RAGå·¥ä½œæµç¨‹è¯¦è§£

#### é˜¶æ®µä¸€ï¼šçŸ¥è¯†åº“æ„å»º (embedding_modelsæ¨¡å—) - å·²å®Œæˆ
```
åŸå§‹æ–‡æ¡£ â†’ æ–‡æ¡£é¢„å¤„ç† â†’ å‘é‡åŒ– â†’ å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“
```

#### é˜¶æ®µäºŒï¼šæŸ¥è¯¢å¤„ç† (knowledge_retrieval_serviceæ¨¡å—) - å½“å‰æ¨¡å—
```
ç”¨æˆ·æŸ¥è¯¢ â†’ å‘é‡åŒ– â†’ æ£€ç´¢åŒ¹é… â†’ ç”Ÿæˆå›ç­”
```

### ğŸ¯ å‘é‡åŒ–æœåŠ¡çš„ä½œç”¨

#### 1. **ç”¨æˆ·æŸ¥è¯¢å‘é‡åŒ–** (ä¸»è¦ç”¨é€”)
```python
# ç”¨æˆ·æŸ¥è¯¢å‘é‡åŒ– - è°ƒç”¨embedding_modelsæœåŠ¡
query_vector = vector_service.text_to_vector("ä»€ä¹ˆæ˜¯å¿ƒè‚Œæ¢—æ­»ï¼Ÿ")
# åœ¨å·²æ„å»ºçš„çŸ¥è¯†åº“ä¸­æ£€ç´¢
similar_vectors = vector_service.search_similar_vectors(query_vector, top_k=5)
```

#### 2. **å¯¹è¯æ—¥å¿—å­˜å‚¨** (å®¹é”™å’Œè®°å½•ç”¨é€”)
```python
# å­˜å‚¨ç”¨æˆ·åŸå§‹è¾“å…¥å’Œå›ç­” - ç”¨äºå¯¹è¯å†å²è®°å½•
conversation_log = {
    "user_input": "ä»€ä¹ˆæ˜¯å¿ƒè‚Œæ¢—æ­»ï¼Ÿ",
    "ai_response": "å¿ƒè‚Œæ¢—æ­»æ˜¯...",
    "timestamp": "2024-01-01 10:00:00",
    "vector_id": "conv_001"
}
```

## ğŸ“Š æ—¥å¿—åŠŸèƒ½å®ç°

### ğŸ¯ æ—¥å¿—è®°å½•ç›®æ ‡

æŒ‰ç…§RAGç³»ç»Ÿçš„å®Œæ•´æµç¨‹ï¼Œä¸ºæ¯ä¸€æ­¥æ“ä½œæ·»åŠ è¯¦ç»†çš„æ—¥å¿—è®°å½•ï¼Œå®ç°ä»¥ä¸‹æµç¨‹çš„æ—¥å¿—è®°å½•ï¼š

**å®Œæ•´æµç¨‹**ï¼šè·å–ç”¨æˆ·è¾“å…¥ â†’ ç”¨æˆ·æ•°æ®å¤„ç† â†’ ç”¨æˆ·æ•°æ®å‘é‡åŒ– â†’ ç”¨æˆ·æ•°æ®æ£€ç´¢ â†’ è°ƒç”¨å¤§æ¨¡å‹ç”Ÿæˆå›ç­” â†’ è¿”å›ç”¨æˆ·ç»“æœ

### âœ… å·²å®ç°çš„æ—¥å¿—åŠŸèƒ½

#### 1. RAG Pipelineæ ¸å¿ƒæµç¨‹æ—¥å¿—

##### 1.1 æŸ¥è¯¢æµç¨‹ (`query` æ–¹æ³•)
- âœ… è·å–ç”¨æˆ·è¾“å…¥å¼€å§‹/ç»“æŸ
- âœ… ç”¨æˆ·æ•°æ®å¤„ç†å¼€å§‹/ç»“æŸ  
- âœ… ç”¨æˆ·æ•°æ®å‘é‡åŒ–å¼€å§‹/ç»“æŸ
- âœ… ç”¨æˆ·æ•°æ®æ£€ç´¢å¼€å§‹/ç»“æŸ
- âœ… æ„å»ºä¸Šä¸‹æ–‡å¼€å§‹/ç»“æŸ
- âœ… è°ƒç”¨å¤§æ¨¡å‹ç”Ÿæˆå›ç­”å¼€å§‹/ç»“æŸ
- âœ… è¿”å›ç”¨æˆ·ç»“æœå¼€å§‹/ç»“æŸ

##### 1.2 å¯¹è¯æµç¨‹ (`chat` æ–¹æ³•)
- âœ… è·å–ç”¨æˆ·è¾“å…¥å¼€å§‹/ç»“æŸ
- âœ… ç”¨æˆ·æ•°æ®å¤„ç†å¼€å§‹/ç»“æŸ
- âœ… ç”¨æˆ·æ•°æ®å‘é‡åŒ–å¼€å§‹/ç»“æŸ
- âœ… ç”¨æˆ·æ•°æ®æ£€ç´¢å¼€å§‹/ç»“æŸ
- âœ… æ„å»ºä¸Šä¸‹æ–‡å¼€å§‹/ç»“æŸ
- âœ… è°ƒç”¨å¤§æ¨¡å‹ç”Ÿæˆå›ç­”å¼€å§‹/ç»“æŸ
- âœ… è¿”å›ç”¨æˆ·ç»“æœå¼€å§‹/ç»“æŸ

##### 1.3 æ‰¹é‡æŸ¥è¯¢æµç¨‹ (`batch_query` æ–¹æ³•)
- âœ… è·å–ç”¨æˆ·è¾“å…¥å¼€å§‹/ç»“æŸ
- âœ… ç”¨æˆ·æ•°æ®å¤„ç†å¼€å§‹/ç»“æŸ
- âœ… æ‰¹é‡å¤„ç†å¼€å§‹/ç»“æŸ
- âœ… è¿”å›ç”¨æˆ·ç»“æœå¼€å§‹/ç»“æŸ

##### 1.4 æ–‡æ¡£æœç´¢æµç¨‹ (`search_documents` æ–¹æ³•)
- âœ… è·å–ç”¨æˆ·è¾“å…¥å¼€å§‹/ç»“æŸ
- âœ… ç”¨æˆ·æ•°æ®å¤„ç†å¼€å§‹/ç»“æŸ
- âœ… æ‰§è¡Œæœç´¢å¼€å§‹/ç»“æŸ
- âœ… è¿”å›ç”¨æˆ·ç»“æœå¼€å§‹/ç»“æŸ

##### 1.5 æ–‡æ¡£æ·»åŠ æµç¨‹ (`add_documents` æ–¹æ³•)
- âœ… è·å–ç”¨æˆ·è¾“å…¥å¼€å§‹/ç»“æŸ
- âœ… ç”¨æˆ·æ•°æ®å¤„ç†å¼€å§‹/ç»“æŸ
- âœ… å¤„ç†æ–‡æœ¬æ–‡æ¡£å¼€å§‹/ç»“æŸ
- âœ… å¤„ç†å›¾åƒæ–‡æ¡£å¼€å§‹/ç»“æŸ
- âœ… è¿”å›ç”¨æˆ·ç»“æœå¼€å§‹/ç»“æŸ

#### 2. APIæ¥å£æ—¥å¿—

##### 2.1 æŸ¥è¯¢æ¥å£ (`/query`)
- âœ… è¯·æ±‚æ¥æ”¶å¼€å§‹/ç»“æŸ
- âœ… å‚æ•°éªŒè¯å¼€å§‹/ç»“æŸ
- âœ… æŸ¥è¯¢å¤„ç†å¼€å§‹/ç»“æŸ
- âœ… å“åº”è¿”å›å¼€å§‹/ç»“æŸ

##### 2.2 å¯¹è¯æ¥å£ (`/chat`)
- âœ… è¯·æ±‚æ¥æ”¶å¼€å§‹/ç»“æŸ
- âœ… å‚æ•°éªŒè¯å¼€å§‹/ç»“æŸ
- âœ… å¯¹è¯å¤„ç†å¼€å§‹/ç»“æŸ
- âœ… å“åº”è¿”å›å¼€å§‹/ç»“æŸ

##### 2.3 æ‰¹é‡æŸ¥è¯¢æ¥å£ (`/batch_query`)
- âœ… è¯·æ±‚æ¥æ”¶å¼€å§‹/ç»“æŸ
- âœ… å‚æ•°éªŒè¯å¼€å§‹/ç»“æŸ
- âœ… æ‰¹é‡å¤„ç†å¼€å§‹/ç»“æŸ
- âœ… å“åº”è¿”å›å¼€å§‹/ç»“æŸ

##### 2.4 æ–‡æ¡£æœç´¢æ¥å£ (`/search`)
- âœ… è¯·æ±‚æ¥æ”¶å¼€å§‹/ç»“æŸ
- âœ… å‚æ•°éªŒè¯å¼€å§‹/ç»“æŸ
- âœ… æœç´¢å¤„ç†å¼€å§‹/ç»“æŸ
- âœ… å“åº”è¿”å›å¼€å§‹/ç»“æŸ

##### 2.5 æ–‡æ¡£æ·»åŠ æ¥å£ (`/add_documents`)
- âœ… è¯·æ±‚æ¥æ”¶å¼€å§‹/ç»“æŸ
- âœ… å‚æ•°éªŒè¯å¼€å§‹/ç»“æŸ
- âœ… æ–‡æ¡£å¤„ç†å¼€å§‹/ç»“æŸ
- âœ… å“åº”è¿”å›å¼€å§‹/ç»“æŸ

#### 3. æœåŠ¡å±‚æ—¥å¿—

##### 3.1 å‘é‡åŒ–æœåŠ¡æ—¥å¿—
- âœ… æ–‡æœ¬å‘é‡åŒ–å¼€å§‹/ç»“æŸ
- âœ… å›¾åƒå‘é‡åŒ–å¼€å§‹/ç»“æŸ
- âœ… å‘é‡æ£€ç´¢å¼€å§‹/ç»“æŸ
- âœ… å‘é‡å­˜å‚¨å¼€å§‹/ç»“æŸ

##### 3.2 æ£€ç´¢æœåŠ¡æ—¥å¿—
- âœ… ç›¸ä¼¼åº¦è®¡ç®—å¼€å§‹/ç»“æŸ
- âœ… ç»“æœæ’åºå¼€å§‹/ç»“æŸ
- âœ… ä¸Šä¸‹æ–‡æ„å»ºå¼€å§‹/ç»“æŸ

##### 3.3 LLMæœåŠ¡æ—¥å¿—
- âœ… æ¨¡å‹åŠ è½½å¼€å§‹/ç»“æŸ
- âœ… æ–‡æœ¬ç”Ÿæˆå¼€å§‹/ç»“æŸ
- âœ… å“åº”å¤„ç†å¼€å§‹/ç»“æŸ

## ğŸ’¾ å¯¹è¯æ—¥å¿—å­˜å‚¨æ¶æ„

### ğŸ¯ å­˜å‚¨ä½ç½®å»ºè®®

#### âœ… **æ¨èæ–¹æ¡ˆï¼šåç«¯APIå±‚å­˜å‚¨**

**ä½ç½®**: `codes/backend/app/modules/conversation/`

**ä¼˜åŠ¿**:
1. **èŒè´£æ¸…æ™°**: åç«¯è´Ÿè´£ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®æŒä¹…åŒ–
2. **æ•°æ®ä¸€è‡´æ€§**: ç»Ÿä¸€çš„æ•°æ®åº“ç®¡ç†ï¼Œé¿å…æ•°æ®åˆ†æ•£
3. **å®‰å…¨æ€§**: åç«¯å¯ä»¥æ§åˆ¶æ•°æ®è®¿é—®æƒé™
4. **å¯æ‰©å±•æ€§**: æ”¯æŒå¤šç”¨æˆ·ã€å¤šä¼šè¯ç®¡ç†
5. **å®¡è®¡è¿½è¸ª**: å®Œæ•´çš„æ“ä½œæ—¥å¿—å’Œç”¨æˆ·è¡Œä¸ºè®°å½•

#### âŒ **ä¸æ¨èï¼šRAGæœåŠ¡å±‚å­˜å‚¨**

**åŸå› **:
1. **èŒè´£æ··ä¹±**: RAGæœåŠ¡ä¸“æ³¨äºæ£€ç´¢å’Œç”Ÿæˆï¼Œä¸åº”æ‰¿æ‹…æ•°æ®å­˜å‚¨èŒè´£
2. **æ•°æ®åˆ†æ•£**: å¯¹è¯æ•°æ®ä¸ä¸šåŠ¡æ•°æ®åˆ†ç¦»ï¼Œéš¾ä»¥ç»Ÿä¸€ç®¡ç†
3. **æ‰©å±•å›°éš¾**: éš¾ä»¥æ”¯æŒå¤šç”¨æˆ·ã€æƒé™æ§åˆ¶ç­‰ä¸šåŠ¡éœ€æ±‚
4. **ç»´æŠ¤å¤æ‚**: æ•°æ®å¤‡ä»½ã€æ¢å¤ã€è¿ç§»ç­‰æ“ä½œå¤æ‚

### ğŸ—ï¸ æ¨èæ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ™ºè¯Šé€šç³»ç»Ÿæ¶æ„                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚   å‰ç«¯å±‚        â”‚    â”‚   åç«¯APIå±‚     â”‚                â”‚
â”‚  â”‚  (Vue.js)       â”‚    â”‚  (FastAPI)      â”‚                â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚                â”‚
â”‚  â”‚ â€¢ ç”¨æˆ·ç•Œé¢      â”‚    â”‚ â€¢ ä¸šåŠ¡é€»è¾‘      â”‚                â”‚
â”‚  â”‚ â€¢ æœ¬åœ°å­˜å‚¨      â”‚    â”‚ â€¢ æ•°æ®åº“ç®¡ç†    â”‚                â”‚
â”‚  â”‚ â€¢ çŠ¶æ€ç®¡ç†      â”‚    â”‚ â€¢ ç”¨æˆ·è®¤è¯      â”‚                â”‚
â”‚  â”‚                 â”‚    â”‚ â€¢ å¯¹è¯æ—¥å¿—å­˜å‚¨  â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚           â”‚                       â”‚                        â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                       â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              RAGæœåŠ¡å±‚                                  â”‚ â”‚
â”‚  â”‚  (knowledge_retrieval_service)                          â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚ â€¢ çŸ¥è¯†æ£€ç´¢                                              â”‚ â”‚
â”‚  â”‚ â€¢ AIå›ç­”ç”Ÿæˆ                                            â”‚ â”‚
â”‚  â”‚ â€¢ å‘é‡åŒ–å¤„ç†                                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶ | èŒè´£ | æ ¸å¿ƒåŠŸèƒ½ |
|------|------|----------|
| **å‘é‡åŒ–æœåŠ¡** | æ–‡æœ¬/å›¾åƒå‘é‡åŒ– | å°†æ–‡æœ¬è½¬æ¢ä¸ºå‘é‡è¡¨ç¤ºï¼Œæ”¯æŒæ‰¹é‡å¤„ç† |
| **æ£€ç´¢æœåŠ¡** | æ–‡æ¡£æ£€ç´¢ | åŸºäºå‘é‡ç›¸ä¼¼åº¦çš„è¯­ä¹‰æœç´¢ï¼Œæ”¯æŒé‡æ’åº |
| **LLMæœåŠ¡** | æ–‡æœ¬ç”Ÿæˆ | åŸºäºæ£€ç´¢ç»“æœç”Ÿæˆå›ç­”ï¼Œæ”¯æŒå¯¹è¯åŠŸèƒ½ |
| **RAGç®¡é“** | æµç¨‹æ•´åˆ | æ•´åˆæ£€ç´¢å’Œç”Ÿæˆæµç¨‹ï¼Œç«¯åˆ°ç«¯å¤„ç† |
| **APIæœåŠ¡** | æ¥å£æä¾› | RESTful APIï¼Œæ”¯æŒå¤šç§æŸ¥è¯¢æ–¹å¼ |

### æŠ€æœ¯æ ˆ

- **åç«¯æ¡†æ¶**: FastAPI
- **å‘é‡æ•°æ®åº“**: ChromaDB (å·²ä»FAISSè¿ç§»)
- **LLMæ¨¡å‹**: Medical_Qwen3_17B
- **å‘é‡åŒ–æ¨¡å‹**: text2vec-base-chinese (768ç»´)
- **ç¼“å­˜**: Redis (å¯é€‰)
- **è´Ÿè½½å‡è¡¡**: Nginx (å¯é€‰)
- **å®¹å™¨åŒ–**: Docker

### ChromaDBè¿ç§»è¯´æ˜

#### è¿ç§»èƒŒæ™¯
å°†knowledge_retrieval_serviceä¸­çš„FAISSå‘é‡æ•°æ®åº“æ›¿æ¢ä¸ºChromaDBï¼Œä»¥ç»Ÿä¸€æ•´ä¸ªç³»ç»Ÿçš„å‘é‡æ•°æ®åº“ä½¿ç”¨ã€‚

#### ä¸»è¦æ›´æ”¹

**1. vector_service.py**
- **åˆå§‹åŒ–æ–¹æ³•**: å°†FAISSç´¢å¼•æ›¿æ¢ä¸ºChromaDBå®ä¾‹
- **æ·»åŠ å‘é‡**: ä½¿ç”¨`add_documents`æ–¹æ³•æ›¿ä»£FAISSçš„`add`æ–¹æ³•
- **æœç´¢æ–¹æ³•**: ä½¿ç”¨`similarity_search_with_score_by_vector`æ›¿ä»£FAISSçš„`search`æ–¹æ³•
- **ä¿å­˜/åŠ è½½**: ChromaDBè‡ªåŠ¨æŒä¹…åŒ–ï¼Œç®€åŒ–äº†ä¿å­˜å’ŒåŠ è½½é€»è¾‘
- **ç»Ÿè®¡ä¿¡æ¯**: ä½¿ç”¨`_collection.count()`æ›¿ä»£FAISSçš„`ntotal`å±æ€§

**2. retrieval_service.py**
- **åˆå§‹åŒ–**: é›†æˆChromaDBå’ŒHuggingFaceEmbeddings
- **æ–‡æ¡£æ·»åŠ **: åŒæ—¶æ”¯æŒChromaDBå’Œæœ¬åœ°numpyæ•°ç»„å­˜å‚¨
- **è¯­ä¹‰æ£€ç´¢**: ä½¿ç”¨ChromaDBçš„ç›¸ä¼¼åº¦æœç´¢API
- **ç»“æœæ ¼å¼**: ç»Ÿä¸€è¿”å›æ ¼å¼ï¼ŒåŒ…å«æ–‡æ¡£å†…å®¹å’Œå…ƒæ•°æ®

**3. requirements.txt**
- ç§»é™¤FAISSä¾èµ–
- æ·»åŠ ChromaDBç›¸å…³ä¾èµ–ï¼š
  - `chromadb>=0.4.0`
  - `langchain-chroma>=0.1.0`
  - `langchain-community>=0.0.10`

#### è¿ç§»ä¼˜åŠ¿

1. **ç»Ÿä¸€æ€§**: æ•´ä¸ªç³»ç»Ÿç°åœ¨éƒ½ä½¿ç”¨ChromaDBä½œä¸ºå‘é‡æ•°æ®åº“
2. **æŒä¹…åŒ–**: ChromaDBæä¾›æ›´å¥½çš„æŒä¹…åŒ–æ”¯æŒ
3. **å…ƒæ•°æ®**: æ›´å¥½çš„å…ƒæ•°æ®ç®¡ç†å’ŒæŸ¥è¯¢èƒ½åŠ›
4. **æ‰©å±•æ€§**: ChromaDBæ”¯æŒæ›´å¤æ‚çš„æŸ¥è¯¢å’Œè¿‡æ»¤
5. **ç»´æŠ¤æ€§**: å‡å°‘äº†å¯¹FAISSçš„ä¾èµ–ï¼Œç®€åŒ–äº†éƒ¨ç½²

#### å…¼å®¹æ€§ä¿è¯

- ä¿ç•™äº†numpyæ•°ç»„ä½œä¸ºå¤‡ç”¨å­˜å‚¨
- ä¿æŒäº†åŸæœ‰çš„APIæ¥å£ä¸å˜
- ç»“æœæ ¼å¼ä¿æŒä¸€è‡´

---

## ğŸ“ é¡¹ç›®ç»“æ„

### æ„å»ºçŸ¥è¯†åº“æ¨¡å— (`codes/ai_models/embedding_models/`)

```
embedding_models/
â”œâ”€â”€ core/                           # æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ vectorization_service.py    # ç»Ÿä¸€å‘é‡åŒ–æœåŠ¡ â­
â”‚   â”œâ”€â”€ medical_knowledge_manager.py # åŒ»ç–—çŸ¥è¯†ç®¡ç†å™¨
â”‚   â”œâ”€â”€ data_analyzer.py            # æ•°æ®åˆ†æå™¨
â”‚   â”œâ”€â”€ build_vector_database.py    # å‘é‡æ•°æ®åº“æ„å»º
â”‚   â”œâ”€â”€ image_vectorization.py      # å›¾åƒå‘é‡åŒ–
â”‚   â”œâ”€â”€ cross_modal_retrieval.py    # è·¨æ¨¡æ€æ£€ç´¢ â­
â”‚   â””â”€â”€ config.json                 # é…ç½®æ–‡ä»¶
â”œâ”€â”€ processors/                     # æ•°æ®å¤„ç†å™¨
â”‚   â”œâ”€â”€ document_chunker.py         # æ–‡æ¡£åˆ‡åˆ†å™¨ â­
â”‚   â”œâ”€â”€ text_preprocessing.py       # æ–‡æœ¬é¢„å¤„ç†
â”‚   â”œâ”€â”€ image_text_preprocessing.py # å›¾åƒæ–‡æœ¬è”åˆå¤„ç†
â”‚   â””â”€â”€ data_pipeline.py           # æ•°æ®å¤„ç†ç®¡é“
â”œâ”€â”€ models/                         # æ¨¡å‹ç›¸å…³
â”‚   â”œâ”€â”€ image_embedder.py          # å›¾åƒåµŒå…¥å™¨
â”‚   â””â”€â”€ pretrained/                # é¢„è®­ç»ƒæ¨¡å‹
â”œâ”€â”€ config/                         # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ unified_config.json        # ç»Ÿä¸€é…ç½®
â”‚   â””â”€â”€ medical_knowledge_config.json # åŒ»ç–—çŸ¥è¯†é…ç½®
â”œâ”€â”€ run_vectorization.py           # å‘é‡åŒ–è¿è¡Œè„šæœ¬
â”œâ”€â”€ test_unified_retrieval.py      # ç»Ÿä¸€æ£€ç´¢æµ‹è¯•
â”œâ”€â”€ requirements.txt               # ä¾èµ–æ–‡ä»¶
â””â”€â”€ æ™ºè¯Šé€šå¤šæ¨¡æ€å‘é‡åŒ–ç³»ç»Ÿå®Œæ•´è¯´æ˜æ–‡æ¡£.md  # å‘é‡åŒ–ç³»ç»Ÿæ–‡æ¡£
```

### æ£€ç´¢æœåŠ¡æ¨¡å— (`codes/services/knowledge_retrieval_service/`)

```
knowledge_retrieval_service/
â”œâ”€â”€ ğŸ“ api/                        # APIæ¥å£å±‚
â”‚   â”œâ”€â”€ ğŸ“ config/                 # é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ rag_config.json        # RAGç³»ç»Ÿé…ç½®
â”‚   â””â”€â”€ rag_api.py                 # APIè·¯ç”±å’Œç«¯ç‚¹
â”œâ”€â”€ ğŸ“ core/                       # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ config_manager.py          # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ llm_service.py             # å¤§æ¨¡å‹æœåŠ¡ (å·²æ›´æ–°)
â”‚   â”œâ”€â”€ rag_pipeline.py            # RAGå¤„ç†ç®¡é“ (å·²æ›´æ–°)
â”‚   â”œâ”€â”€ retrieval_service.py       # æ£€ç´¢æœåŠ¡
â”‚   â””â”€â”€ vector_service.py          # å‘é‡æœåŠ¡
â”œâ”€â”€ ğŸ“ docs_backup/                # æ–‡æ¡£å¤‡ä»½
â”œâ”€â”€ ğŸ“ venv/                       # è™šæ‹Ÿç¯å¢ƒ
â”œâ”€â”€ ğŸš€ å¯åŠ¨è„šæœ¬
â”‚   â”œâ”€â”€ start_rag_service.py       # ä¸»å¯åŠ¨è„šæœ¬
â”‚   â”œâ”€â”€ start_with_streaming.sh    # æµå¼åŠŸèƒ½å¯åŠ¨è„šæœ¬
â”‚   â”œâ”€â”€ quick_start.py             # å¿«é€Ÿå¯åŠ¨è„šæœ¬
â”‚   â””â”€â”€ deploy_rag_service.sh      # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ ğŸ§ª æµ‹è¯•å’Œæ¼”ç¤º
â”‚   â”œâ”€â”€ test_streaming.py          # æµå¼åŠŸèƒ½æµ‹è¯•
â”‚   â”œâ”€â”€ test_streaming.html        # Webæµ‹è¯•ç•Œé¢
â”‚   â”œâ”€â”€ demo.py                    # åŠŸèƒ½æ¼”ç¤ºè„šæœ¬
â”‚   â”œâ”€â”€ quick_test.py              # å¿«é€Ÿæµ‹è¯•
â”‚   â”œâ”€â”€ test_complete_rag_flow.py  # å®Œæ•´æµ‹è¯•å¥—ä»¶
â”‚   â”œâ”€â”€ demo_rag_system.py         # æ¼”ç¤ºè„šæœ¬
â”‚   â””â”€â”€ test_rag_logs.py           # æ—¥å¿—æµ‹è¯•è„šæœ¬
â”œâ”€â”€ ğŸ“– æ–‡æ¡£
â”‚   â”œâ”€â”€ STREAMING_GUIDE.md         # æµå¼åŠŸèƒ½ä½¿ç”¨æŒ‡å—
â”‚   â”œâ”€â”€ UPDATE_SUMMARY.md          # æ›´æ–°æ€»ç»“
â”‚   â”œâ”€â”€ PROJECT_STRUCTURE.md       # é¡¹ç›®ç»“æ„è¯´æ˜
â”‚   â”œâ”€â”€ CHROMADB_MIGRATION.md      # ChromaDBè¿ç§»è¯´æ˜
â”‚   â””â”€â”€ æ™ºè¯Šé€šRAGæ£€ç´¢å¢å¼ºç³»ç»Ÿå®Œæ•´è¯´æ˜æ–‡æ¡£.md
â”œâ”€â”€ ğŸ³ éƒ¨ç½²æ–‡ä»¶
â”‚   â”œâ”€â”€ Dockerfile                 # Dockeré•œåƒ
â”‚   â”œâ”€â”€ docker-compose.yml         # Dockerç¼–æ’
â”‚   â”œâ”€â”€ nginx.conf                 # Nginxé…ç½®
â”‚   â””â”€â”€ requirements.txt           # Pythonä¾èµ–
â””â”€â”€ ğŸ”§ å·¥å…·è„šæœ¬
    â”œâ”€â”€ monitor.sh                 # ç›‘æ§è„šæœ¬
    â”œâ”€â”€ quick_start.sh             # å¿«é€Ÿå¯åŠ¨è„šæœ¬
    â””â”€â”€ deploy.sh                  # ç®€åŒ–éƒ¨ç½²è„šæœ¬
```

### å¤§è¯­è¨€æ¨¡å‹æ¨¡å— (`codes/ai_models/llm_models/`)

```
llm_models/
â”œâ”€â”€ Medical_Qwen3_17B/            # åŒ»ç–—å¤§è¯­è¨€æ¨¡å‹ â­
â”‚   â”œâ”€â”€ config.json               # æ¨¡å‹é…ç½®
â”‚   â”œâ”€â”€ pytorch_model.bin         # æ¨¡å‹æƒé‡
â”‚   â”œâ”€â”€ tokenizer.json            # åˆ†è¯å™¨
â”‚   â””â”€â”€ ...                       # å…¶ä»–æ¨¡å‹æ–‡ä»¶
â”œâ”€â”€ text2vec-base-chinese/        # ä¸­æ–‡æ–‡æœ¬å‘é‡åŒ–æ¨¡å‹ â­
â”‚   â”œâ”€â”€ config.json               # æ¨¡å‹é…ç½®
â”‚   â”œâ”€â”€ pytorch_model.bin         # æ¨¡å‹æƒé‡
â”‚   â”œâ”€â”€ tokenizer.json            # åˆ†è¯å™¨
â”‚   â””â”€â”€ ...                       # å…¶ä»–æ¨¡å‹æ–‡ä»¶
â”œâ”€â”€ model_config.json             # æ¨¡å‹é…ç½®æ–‡ä»¶
â”œâ”€â”€ test_model.py                 # æ¨¡å‹æµ‹è¯•è„šæœ¬
â”œâ”€â”€ æœ¬åœ°æ¨¡å‹ä½¿ç”¨æŒ‡å—.md           # æ¨¡å‹ä½¿ç”¨æ–‡æ¡£
â””â”€â”€ MODEL_INFO.md                 # æ¨¡å‹ä¿¡æ¯æ–‡æ¡£
```

### å‘é‡æ•°æ®åº“æ¨¡å— (`codes/chroma_db/`)

```
chroma_db/
â”œâ”€â”€ chroma.sqlite3                # å‘é‡æ•°æ®åº“æ–‡ä»¶ â­
â””â”€â”€ [collection_id]/              # é›†åˆæ•°æ®ç›®å½•
    â”œâ”€â”€ data_level0.bin           # æ•°æ®æ–‡ä»¶
    â”œâ”€â”€ header.bin                # å¤´éƒ¨ä¿¡æ¯
    â”œâ”€â”€ index_metadata.pickle     # ç´¢å¼•å…ƒæ•°æ®
    â”œâ”€â”€ length.bin                # é•¿åº¦ä¿¡æ¯
    â””â”€â”€ link_lists.bin            # é“¾æ¥åˆ—è¡¨
```

### æ•°æ®å­˜å‚¨æ¨¡å— (`datas/`)

```
datas/
â”œâ”€â”€ medical_knowledge/            # åŒ»ç–—çŸ¥è¯†åº“ â­
â”‚   â”œâ”€â”€ text_data/                # æ–‡æœ¬æ•°æ®
â”‚   â”‚   â”œâ”€â”€ raw/                  # åŸå§‹æ•°æ®
â”‚   â”‚   â”œâ”€â”€ processed/            # å¤„ç†åæ•°æ®
â”‚   â”‚   â””â”€â”€ embeddings/           # å‘é‡æ•°æ®
â”‚   â”œâ”€â”€ image_text_data/          # å›¾åƒæ–‡æœ¬æ•°æ®
â”‚   â”‚   â”œâ”€â”€ raw/                  # åŸå§‹æ•°æ®
â”‚   â”‚   â”œâ”€â”€ processed/            # å¤„ç†åæ•°æ®
â”‚   â”‚   â””â”€â”€ embeddings/           # å‘é‡æ•°æ®
â”‚   â”œâ”€â”€ voice_data/               # è¯­éŸ³æ•°æ®
â”‚   â”‚   â”œâ”€â”€ raw/                  # åŸå§‹æ•°æ®
â”‚   â”‚   â”œâ”€â”€ processed/            # å¤„ç†åæ•°æ®
â”‚   â”‚   â””â”€â”€ embeddings/           # å‘é‡æ•°æ®
â”‚   â”œâ”€â”€ vector_databases/         # å‘é‡æ•°æ®åº“
â”‚   â”‚   â”œâ”€â”€ text/                 # æ–‡æœ¬å‘é‡æ•°æ®åº“
â”‚   â”‚   â”œâ”€â”€ image/                # å›¾åƒå‘é‡æ•°æ®åº“
â”‚   â”‚   â”œâ”€â”€ voice/                # è¯­éŸ³å‘é‡æ•°æ®åº“
â”‚   â”‚   â””â”€â”€ multimodal/           # å¤šæ¨¡æ€å‘é‡æ•°æ®åº“
â”‚   â”œâ”€â”€ dialogue_data/            # å¯¹è¯æ•°æ®
â”‚   â”œâ”€â”€ training_data/            # è®­ç»ƒæ•°æ®
â”‚   â””â”€â”€ test_data/                # æµ‹è¯•æ•°æ®
â””â”€â”€ vector_databases/             # å‘é‡æ•°æ®åº“å¤‡ä»½
    â”œâ”€â”€ image/
    â”œâ”€â”€ multimodal/
    â”œâ”€â”€ text/
    â””â”€â”€ voice/
```

---

## ğŸ”„ æ ¸å¿ƒå·¥ä½œæµç¨‹

### 1. çŸ¥è¯†åº“æ„å»ºæµç¨‹

```
åŸå§‹æ•°æ® â†’ æ–‡æ¡£åŠ è½½ â†’ æ•°æ®æ¸…æ´— â†’ æ–‡æ¡£åˆ‡åˆ† â†’ å‘é‡åŒ– â†’ è´¨é‡æ£€æŸ¥ â†’ ç´¢å¼•æ„å»º
   â†“         â†“         â†“         â†“         â†“         â†“         â†“
Word/PDF  å¤šæ ¼å¼    å»é‡/è¿‡æ»¤   Chunk    å‘é‡è¡¨ç¤º   å»é‡/è¿‡æ»¤   å‘é‡æ•°æ®åº“
TXT/Excel æ”¯æŒ      æ ‡å‡†åŒ–     åˆ‡åˆ†      ç”Ÿæˆ      è´¨é‡è¯„ä¼°   FAISS
```

#### 1.1 æ–‡æ¡£åŠ è½½ (Document Loading)
- **æ”¯æŒæ ¼å¼**ï¼šWordã€PDFã€TXTã€Excelã€JSONã€å›¾åƒæ–‡ä»¶
- **å®ç°ä½ç½®**ï¼š`processors/data_pipeline.py`
- **æ ¸å¿ƒç±»**ï¼š`DataPipeline`

#### 1.2 æ•°æ®æ¸…æ´— (Data Cleaning)
- **åŠŸèƒ½**ï¼šå»é™¤é‡å¤æ•°æ®ã€æ ‡å‡†åŒ–æ ¼å¼ã€å¤„ç†ç¼ºå¤±å€¼
- **å®ç°ä½ç½®**ï¼š`processors/text_preprocessing.py`
- **æ ¸å¿ƒç±»**ï¼š`OptimizedMedicalTextPreprocessor`

#### 1.3 æ–‡æ¡£åˆ‡åˆ† (Document Chunking) â­
- **åŠŸèƒ½**ï¼šå°†é•¿æ–‡æ¡£åˆ‡åˆ†ä¸ºé€‚åˆå‘é‡åŒ–çš„å°ç‰‡æ®µ
- **å®ç°ä½ç½®**ï¼š`processors/document_chunker.py`
- **æ ¸å¿ƒç±»**ï¼š`DocumentChunker`

**åˆ‡åˆ†ç­–ç•¥**ï¼š
- `FIXED_SIZE`ï¼šå›ºå®šå¤§å°åˆ‡åˆ†
- `SENTENCE_BASED`ï¼šåŸºäºå¥å­åˆ‡åˆ†
- `PARAGRAPH_BASED`ï¼šåŸºäºæ®µè½åˆ‡åˆ†
- `SEMANTIC_BASED`ï¼šåŸºäºè¯­ä¹‰åˆ‡åˆ†
- `MEDICAL_STRUCTURED`ï¼šåŒ»ç–—ç»“æ„åŒ–åˆ‡åˆ† â­

#### 1.4 å‘é‡åŒ– (Vectorization)
- **åŠŸèƒ½**ï¼šå°†æ–‡æœ¬å’Œå›¾åƒè½¬æ¢ä¸ºå‘é‡è¡¨ç¤º
- **å®ç°ä½ç½®**ï¼š`core/vectorization_service.py`
- **æ ¸å¿ƒç±»**ï¼š`VectorizationService`

**å‘é‡åŒ–æ¨¡å‹**ï¼š
- **æ–‡æœ¬æ¨¡å‹**ï¼š`text2vec-base-chinese` (768ç»´)
- **å›¾åƒæ¨¡å‹**ï¼š`openai/clip-vit-base-patch32` (512ç»´)

### 2. RAGæ£€ç´¢æµç¨‹

```
ç”¨æˆ·é—®é¢˜ â†’ å‘é‡åŒ– â†’ å‘é‡æ£€ç´¢ â†’ æ–‡æ¡£æ’åº â†’ ä¸Šä¸‹æ–‡æ„å»º â†’ LLMç”Ÿæˆ â†’ è¿”å›ç­”æ¡ˆ
    â†“         â†“         â†“         â†“         â†“         â†“
  æ–‡æœ¬è¾“å…¥   å‘é‡è¡¨ç¤º   ç›¸ä¼¼æ–‡æ¡£   é‡æ’åº    æç¤ºæ¨¡æ¿   æœ€ç»ˆç­”æ¡ˆ
```

#### 2.1 é—®é¢˜é¢„å¤„ç†
- æ–‡æœ¬æ¸…æ´—å’Œæ ‡å‡†åŒ–
- å…³é”®è¯æå–
- æ„å›¾è¯†åˆ«

#### 2.2 å‘é‡æ£€ç´¢
- åŸºäºFAISSçš„å¿«é€Ÿæ£€ç´¢
- æ”¯æŒå¤šç§ç›¸ä¼¼åº¦ç®—æ³•
- ç»“æœé‡æ’åºä¼˜åŒ–

#### 2.3 ç­”æ¡ˆç”Ÿæˆ
- åŸºäºMedical_Qwen3_17Bæ¨¡å‹
- ä¸Šä¸‹æ–‡æ„ŸçŸ¥ç”Ÿæˆ
- å¤šè½®å¯¹è¯æ”¯æŒ

---

## ğŸ“Š æ•°æ®å­˜å‚¨ç»“æ„

### æ•°æ®ç›®å½•ç»“æ„

```
datas/medical_knowledge/
â”œâ”€â”€ text_data/                     # æ–‡æœ¬æ•°æ®
â”‚   â”œâ”€â”€ raw/                      # åŸå§‹æ•°æ®
â”‚   â”œâ”€â”€ processed/                # å¤„ç†åæ•°æ®
â”‚   â””â”€â”€ embeddings/               # å‘é‡æ•°æ®
â”œâ”€â”€ image_text_data/              # å›¾åƒæ–‡æœ¬æ•°æ®
â”‚   â”œâ”€â”€ raw/                      # åŸå§‹æ•°æ®
â”‚   â”œâ”€â”€ processed/                # å¤„ç†åæ•°æ®
â”‚   â””â”€â”€ embeddings/               # å‘é‡æ•°æ®
â”œâ”€â”€ voice_data/                   # è¯­éŸ³æ•°æ®
â”‚   â”œâ”€â”€ raw/                      # åŸå§‹æ•°æ®
â”‚   â”œâ”€â”€ processed/                # å¤„ç†åæ•°æ®
â”‚   â””â”€â”€ embeddings/               # å‘é‡æ•°æ®
â””â”€â”€ vector_databases/             # å‘é‡æ•°æ®åº“
    â”œâ”€â”€ text/                     # æ–‡æœ¬å‘é‡æ•°æ®åº“
    â”œâ”€â”€ image/                    # å›¾åƒå‘é‡æ•°æ®åº“
    â”œâ”€â”€ voice/                    # è¯­éŸ³å‘é‡æ•°æ®åº“
    â””â”€â”€ multimodal/               # å¤šæ¨¡æ€å‘é‡æ•°æ®åº“
```

### é…ç½®ç®¡ç†

**ç»Ÿä¸€é…ç½®æ–‡ä»¶**ï¼š`config/unified_config.json`

```json
{
  "models": {
    "text_embedding": {
      "model_name": "text2vec-base-chinese",
      "model_path": "../llm_models/text2vec-base-chinese",
      "max_length": 512,
      "batch_size": 32
    },
    "image_embedding": {
      "model_name": "clip-vit-base-patch32",
      "model_path": "models/pretrained/clip-vit-base-patch32",
      "image_size": 224,
      "batch_size": 16
    }
  },
  "data": {
    "base_dir": "/path/to/medical_knowledge",
    "text_data": {
      "raw_dir": "text_data/raw",
      "processed_dir": "text_data/processed",
      "embeddings_dir": "text_data/embeddings",
      "vector_db_dir": "vector_databases/text"
    }
  }
}
```

---

## ğŸŒŠ æµå¼åŠŸèƒ½è¯¦è§£

### åŠŸèƒ½æ¦‚è¿°

RAGç³»ç»Ÿæ–°å¢äº†ä¸¤ä¸ªé‡è¦åŠŸèƒ½ï¼š
1. **å†…å®¹æ‘˜è¦åŠŸèƒ½** - å°†æ£€ç´¢åˆ°çš„å†…å®¹å…ˆæ‘˜è¦åˆ°50å­—ä»¥å†…ï¼Œæé«˜å›ç­”è´¨é‡
2. **æµå¼è¾“å‡ºåŠŸèƒ½** - æ”¯æŒå®æ—¶æµå¼å“åº”ï¼Œæä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ

### æ ¸å¿ƒç»„ä»¶æ›´æ–°

#### 1. RAG Pipeline (`core/rag_pipeline.py`)

**å†…å®¹æ‘˜è¦åŠŸèƒ½**ï¼š
```python
def _summarize_content(self, content: str, max_length: int = 50) -> str:
    """å°†å†…å®¹æ‘˜è¦åˆ°æŒ‡å®šé•¿åº¦"""
    # è‡ªåŠ¨æ‘˜è¦æ£€ç´¢åˆ°çš„æ–‡æ¡£å†…å®¹
    # ä¿ç•™å…³é”®åŒ»å­¦ä¿¡æ¯
    # æé«˜å¤§æ¨¡å‹å¤„ç†æ•ˆç‡
```

**æµå¼æŸ¥è¯¢æ–¹æ³•**ï¼š
```python
async def query_stream(self, question: str, top_k: int = 5, 
                      response_type: str = "general", 
                      similarity_threshold: float = 200.0):
    """æµå¼æŸ¥è¯¢æ–¹æ³•"""
    # å®æ—¶æ˜¾ç¤ºç”Ÿæˆå†…å®¹
    # çŠ¶æ€åé¦ˆå’Œè¿›åº¦æç¤º
    # æ–‡æ¡£æ£€ç´¢åç«‹å³å±•ç¤º
```

#### 2. LLM Service (`core/llm_service.py`)

**æµå¼ç”Ÿæˆæ”¯æŒ**ï¼š
```python
async def generate_stream(self, prompt: str, max_tokens: int = 1000) -> AsyncGenerator[str, None]:
    """æµå¼ç”Ÿæˆå›ç­”"""
    # å¼‚æ­¥ç”Ÿæˆå™¨æ¨¡å¼
    # å®æ—¶å†…å®¹è¾“å‡º
    # å†…å­˜æ•ˆç‡ä¼˜åŒ–
```

#### 3. APIç«¯ç‚¹ (`api/rag_api.py`)

**æµå¼æŸ¥è¯¢ç«¯ç‚¹**ï¼š
```python
@router.post("/query/stream")
async def query_stream(request: QueryRequest):
    """æµå¼æŸ¥è¯¢ç«¯ç‚¹"""
    # Server-Sent Eventsæ ¼å¼
    # å®æ—¶çŠ¶æ€æ›´æ–°
    # ç»“æ„åŒ–å“åº”æ ¼å¼
```

### æµå¼APIæ¥å£

#### æµå¼æŸ¥è¯¢æ¥å£

**ç«¯ç‚¹**: `POST /query/stream`

**è¯·æ±‚å‚æ•°**:
```json
{
    "question": "å¿ƒè‚Œæ¢—æ­»æœ‰ä»€ä¹ˆç—‡çŠ¶ï¼Ÿ",
    "top_k": 5,
    "response_type": "general",
    "similarity_threshold": 200.0
}
```

**å“åº”æ ¼å¼** (Server-Sent Events):
```
data: {"type": "status", "message": "å¼€å§‹æ£€ç´¢ç›¸å…³æ–‡æ¡£..."}

data: {"type": "content", "content": "å¿ƒè‚Œæ¢—æ­»çš„ä¸»è¦ç—‡çŠ¶åŒ…æ‹¬ï¼š"}

data: {"type": "content", "content": "1. èƒ¸ç—›"}

data: {"type": "documents", "documents": [...]}

data: {"type": "complete", "message": "æŸ¥è¯¢å®Œæˆ"}
```

### æ€§èƒ½å¯¹æ¯”

| åŠŸèƒ½ | å¸¸è§„æŸ¥è¯¢ | æµå¼æŸ¥è¯¢ |
|------|----------|----------|
| å“åº”æ–¹å¼ | ä¸€æ¬¡æ€§è¿”å› | å®æ—¶æµå¼ |
| ç”¨æˆ·ä½“éªŒ | ç­‰å¾…å®Œæ•´ç»“æœ | å®æ—¶çœ‹åˆ°è¿›åº¦ |
| é”™è¯¯å¤„ç† | ç»Ÿä¸€é”™è¯¯ä¿¡æ¯ | å®æ—¶é”™è¯¯æç¤º |
| æ–‡æ¡£å±•ç¤º | æœ€åæ˜¾ç¤º | æ£€ç´¢åç«‹å³æ˜¾ç¤º |
| é€‚ç”¨åœºæ™¯ | ç®€å•æŸ¥è¯¢ | å¤æ‚æŸ¥è¯¢ã€æ¼”ç¤º |

### ä½¿ç”¨åœºæ™¯

1. **å®æ—¶æ¼”ç¤º** - å±•ç¤ºRAGç³»ç»Ÿèƒ½åŠ›ï¼Œå®æ—¶çœ‹åˆ°æ£€ç´¢å’Œç”Ÿæˆè¿‡ç¨‹
2. **å¤æ‚æŸ¥è¯¢** - é•¿æ—¶é—´ç”Ÿæˆè¿‡ç¨‹ï¼Œç”¨æˆ·å¯ä»¥çœ‹åˆ°è¿›åº¦
3. **è°ƒè¯•å’Œå¼€å‘** - å®æ—¶çœ‹åˆ°ç³»ç»ŸçŠ¶æ€ï¼Œå¿«é€Ÿå®šä½é—®é¢˜

---

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. ç»Ÿä¸€å‘é‡åŒ–æœåŠ¡

**å®ç°ä½ç½®**ï¼š`core/vectorization_service.py`

**æœåŠ¡ç‰¹æ€§**ï¼š
- æ–‡æœ¬å‘é‡åŒ–
- å›¾åƒå‘é‡åŒ–
- å¤šæ¨¡æ€å¤„ç†
- æ‰¹é‡å¤„ç†ä¼˜åŒ–

```python
# ä½¿ç”¨ç¤ºä¾‹
from core.vectorization_service import VectorizationService

# åˆå§‹åŒ–å‘é‡åŒ–æœåŠ¡
service = VectorizationService()

# æ–‡æœ¬å‘é‡åŒ–
text_vectors = service.process_texts(texts)

# å›¾åƒå‘é‡åŒ–
image_vectors = service.process_images(image_paths)

# å¤šæ¨¡æ€å¤„ç†
result = service.process_multimodal(texts, image_paths)
```

### 2. è·¨æ¨¡æ€æ£€ç´¢åŠŸèƒ½ â­

**å®ç°ä½ç½®**ï¼š`core/cross_modal_retrieval.py`

**åŠŸèƒ½ç‰¹æ€§**ï¼š
- æ–‡æœ¬åˆ°æ–‡æœ¬æ£€ç´¢
- å›¾åƒåˆ°æ–‡æœ¬æ£€ç´¢
- æ··åˆæ£€ç´¢ï¼ˆæ–‡æœ¬+å›¾åƒï¼‰

```python
# ä½¿ç”¨ç¤ºä¾‹
from core.simple_cross_modal_retrieval import SimpleCrossModalRetrieval

# åˆå§‹åŒ–æ£€ç´¢ç³»ç»Ÿ
retrieval_system = SimpleCrossModalRetrieval()

# æ–‡æœ¬æ£€ç´¢
text_results = retrieval_system.search_by_text("å† å¿ƒç—…ç—‡çŠ¶", top_k=5)

# å›¾åƒåˆ°æ–‡æœ¬æ£€ç´¢
image_results = retrieval_system.search_by_image("path/to/image.jpg", top_k=5)

# æ··åˆæ£€ç´¢
mixed_results = retrieval_system.search_by_text_with_image(
    "å¿ƒè„ç–¾ç—…", "path/to/image.jpg", top_k=5
)
```

### 3. æ–‡æ¡£åˆ‡åˆ†åŠŸèƒ½ â­

**å®ç°ä½ç½®**ï¼š`processors/document_chunker.py`

**åˆ‡åˆ†ç­–ç•¥**ï¼š
- åŒ»ç–—ç»“æ„åŒ–åˆ‡åˆ†ï¼šè¯†åˆ«åŒ»ç–—æ–‡æ¡£ç« èŠ‚
- å¥å­è¾¹ç•Œåˆ‡åˆ†ï¼šä¿æŒå¥å­å®Œæ•´æ€§
- æ®µè½è¾¹ç•Œåˆ‡åˆ†ï¼šä¿æŒæ®µè½å®Œæ•´æ€§
- å›ºå®šå¤§å°åˆ‡åˆ†ï¼šé€‚åˆæ‰¹é‡å¤„ç†

```python
# ä½¿ç”¨ç¤ºä¾‹
from processors.document_chunker import create_medical_chunker

# åˆ›å»ºåŒ»ç–—æ–‡æ¡£åˆ‡åˆ†å™¨
chunker = create_medical_chunker()

# åˆ‡åˆ†æ–‡æ¡£
chunks = chunker.chunk_document(medical_text, metadata)

# æ‰¹é‡å¤„ç†æ–‡ä»¶
results = chunker.batch_chunk_files(input_dir, output_dir)
```

### 4. RAGç®¡é“æœåŠ¡

**å®ç°ä½ç½®**ï¼š`core/rag_pipeline.py`

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- ç«¯åˆ°ç«¯RAGæµç¨‹
- å¤šæ¨¡æ€æ”¯æŒ
- æ‰¹é‡å¤„ç†
- ç³»ç»Ÿç®¡ç†

```python
# ä½¿ç”¨ç¤ºä¾‹
from core.rag_pipeline import RAGPipelineFactory

# åˆ›å»ºRAGæµç¨‹å®ä¾‹
rag_pipeline = RAGPipelineFactory.create_rag_pipeline()

# æ·»åŠ æ–‡æ¡£
documents = [
    {
        "content": "å¿ƒè‚Œæ¢—æ­»æ˜¯ç”±äºå† çŠ¶åŠ¨è„‰æ€¥æ€§é—­å¡å¯¼è‡´å¿ƒè‚Œç¼ºè¡€åæ­»çš„å¿ƒè¡€ç®¡ç–¾ç—…ã€‚",
        "title": "å¿ƒè‚Œæ¢—æ­»å®šä¹‰",
        "category": "å¿ƒè¡€ç®¡ç–¾ç—…",
        "source": "åŒ»å­¦æ•™ç§‘ä¹¦"
    }
]
rag_pipeline.add_documents(documents)

# æŸ¥è¯¢
result = rag_pipeline.query("ä»€ä¹ˆæ˜¯å¿ƒè‚Œæ¢—æ­»ï¼Ÿ", top_k=5)
print(f"Answer: {result['answer']}")

# å¯¹è¯
messages = [{"role": "user", "content": "å¿ƒè‚Œæ¢—æ­»æœ‰ä»€ä¹ˆç—‡çŠ¶ï¼Ÿ"}]
chat_result = rag_pipeline.chat(messages)
print(f"Chat answer: {chat_result['answer']}")
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# ç¡®ä¿Python 3.8+å·²å®‰è£…
python3 --version

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. æ¨¡å‹å‡†å¤‡

```bash
# ç¡®ä¿Medical_Qwen3_17Bæ¨¡å‹å·²ä¸‹è½½åˆ°æ­£ç¡®ä½ç½®
# è·¯å¾„: ../../ai_models/llm_models/Medical_Qwen3_17B

# æ£€æŸ¥æ¨¡å‹æ–‡ä»¶
ls -la ../../ai_models/llm_models/Medical_Qwen3_17B/
ls -la ../../ai_models/llm_models/text2vec-base-chinese/

# å¦‚æœæ¨¡å‹ä¸å­˜åœ¨ï¼Œå¯ä»¥ä¸‹è½½æˆ–ä½¿ç”¨æ¨¡æ‹ŸæœåŠ¡
# æ¨¡æ‹ŸæœåŠ¡ä¸éœ€è¦æ¨¡å‹æ–‡ä»¶ï¼Œé€‚åˆæµ‹è¯•ä½¿ç”¨
```

### 3. å¯åŠ¨æœåŠ¡

#### ä½¿ç”¨æ¨¡æ‹ŸæœåŠ¡ï¼ˆæ¨èç”¨äºæµ‹è¯•ï¼‰
```bash
cd codes/services/knowledge_retrieval_service
python mock_rag_service.py
```

#### ä½¿ç”¨å®Œæ•´æœåŠ¡ï¼ˆéœ€è¦æ¨¡å‹æ–‡ä»¶ï¼‰
```bash
cd codes/services/knowledge_retrieval_service
python start_rag_service.py
```

#### ä½¿ç”¨å¿«é€Ÿå¯åŠ¨è„šæœ¬
```bash
cd codes/services/knowledge_retrieval_service
./quick_start.sh
```

#### ä½¿ç”¨Dockeréƒ¨ç½²
```bash
cd codes/services/knowledge_retrieval_service
docker compose up -d
```

### 4. éªŒè¯æœåŠ¡çŠ¶æ€
```bash
curl http://localhost:8000/health
```

### 5. è¿è¡Œæµ‹è¯•
```bash
# å¿«é€Ÿæµ‹è¯•
python quick_test.py

# å®Œæ•´æµ‹è¯•å¥—ä»¶
python test_complete_rag_flow.py

# æ—¥å¿—åŠŸèƒ½æµ‹è¯•
python test_rag_logs.py

# æ¼”ç¤ºè„šæœ¬
python demo_rag_system.py
```

---

## ğŸ“– ä½¿ç”¨æŒ‡å—

### 1. APIæ¥å£ä½¿ç”¨

#### æ ¹è·¯å¾„ä¿¡æ¯
```bash
curl http://localhost:8000/
```

#### å¥åº·æ£€æŸ¥
```bash
curl http://localhost:8000/health
```

#### æ·»åŠ æ–‡æ¡£
```bash
curl -X POST http://localhost:8000/documents \
  -H "Content-Type: application/json" \
  -d '[
    {
      "content": "å¿ƒè‚Œæ¢—æ­»æ˜¯ç”±äºå† çŠ¶åŠ¨è„‰æ€¥æ€§é—­å¡å¯¼è‡´å¿ƒè‚Œç¼ºè¡€åæ­»çš„å¿ƒè¡€ç®¡ç–¾ç—…ã€‚",
      "title": "å¿ƒè‚Œæ¢—æ­»å®šä¹‰",
      "category": "å¿ƒè¡€ç®¡ç–¾ç—…",
      "source": "åŒ»å­¦æ•™ç§‘ä¹¦",
      "metadata": {},
      "type": "text"
    }
  ]'
```

#### æ·»åŠ å›¾åƒæ–‡æ¡£
```bash
curl -X POST http://localhost:8000/documents/images \
  -H "Content-Type: application/json" \
  -d '[
    {
      "image_path": "/path/to/image.jpg",
      "title": "å¿ƒç”µå›¾å›¾åƒ",
      "category": "å¿ƒè¡€ç®¡ç–¾ç—…",
      "source": "åŒ»å­¦å½±åƒ",
      "metadata": {}
    }
  ]'
```

#### æŸ¥è¯¢æ–‡æ¡£
```bash
curl -X POST http://localhost:8000/query \
  -H "Content-Type: application/json" \
  -d '{
    "question": "ä»€ä¹ˆæ˜¯å¿ƒè‚Œæ¢—æ­»ï¼Ÿ",
    "top_k": 5,
    "response_type": "general"
  }'
```

#### æµå¼æŸ¥è¯¢æ–‡æ¡£
```bash
curl -X POST http://localhost:8000/query/stream \
  -H "Content-Type: application/json" \
  -d '{
    "question": "ä»€ä¹ˆæ˜¯å¿ƒè‚Œæ¢—æ­»ï¼Ÿ",
    "top_k": 5,
    "response_type": "general",
    "similarity_threshold": 200.0
  }'
```

#### å¯¹è¯åŠŸèƒ½
```bash
curl -X POST http://localhost:8000/chat \
  -H "Content-Type: application/json" \
  -d '{
    "messages": [
      {"role": "user", "content": "æˆ‘æœ€è¿‘ç»å¸¸æ„Ÿåˆ°èƒ¸ç—›ï¼Œè¿™æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ"}
    ],
    "top_k": 5
  }'
```

#### æœç´¢æ–‡æ¡£
```bash
curl -X POST http://localhost:8000/search \
  -H "Content-Type: application/json" \
  -d '{
    "query": "å¿ƒè‚Œæ¢—æ­»",
    "search_type": "semantic",
    "top_k": 10
  }'
```

#### æ‰¹é‡æŸ¥è¯¢
```bash
curl -X POST http://localhost:8000/batch_query \
  -H "Content-Type: application/json" \
  -d '{
    "questions": [
      "ä»€ä¹ˆæ˜¯å¿ƒè‚Œæ¢—æ­»ï¼Ÿ",
      "è´«è¡€æœ‰ä»€ä¹ˆç—‡çŠ¶ï¼Ÿ",
      "å¦‚ä½•é¢„é˜²å‘¼å¸é“æ„ŸæŸ“ï¼Ÿ"
    ],
    "top_k": 5
  }'
```

#### è·å–ç³»ç»Ÿç»Ÿè®¡
```bash
curl http://localhost:8000/stats
```

#### ä¿å­˜ç³»ç»ŸçŠ¶æ€
```bash
curl -X POST http://localhost:8000/save \
  -H "Content-Type: application/json" \
  -d '"save_directory"'
```

#### åŠ è½½ç³»ç»ŸçŠ¶æ€
```bash
curl -X POST http://localhost:8000/load \
  -H "Content-Type: application/json" \
  -d '"load_directory"'
```

#### æ¸…ç©ºç³»ç»Ÿæ•°æ®
```bash
curl -X DELETE http://localhost:8000/clear
```

### 2. Python SDKä½¿ç”¨

```python
import requests

# æ·»åŠ åŒ»ç–—æ–‡æ¡£
documents = [
    {
        "content": "å¿ƒè‚Œæ¢—æ­»æ˜¯ç”±äºå† çŠ¶åŠ¨è„‰æ€¥æ€§é—­å¡å¯¼è‡´å¿ƒè‚Œç¼ºè¡€åæ­»çš„å¿ƒè¡€ç®¡ç–¾ç—…ã€‚",
        "title": "å¿ƒè‚Œæ¢—æ­»æ¦‚è¿°",
        "category": "å¿ƒè¡€ç®¡ç–¾ç—…",
        "source": "åŒ»å­¦æ•™ç§‘ä¹¦"
    }
]

response = requests.post(
    "http://localhost:8000/documents",
    json=documents
)
print(response.json())

# å•æ¬¡æŸ¥è¯¢
query_data = {
    "question": "ä»€ä¹ˆæ˜¯å¿ƒè‚Œæ¢—æ­»ï¼Ÿ",
    "top_k": 3,
    "response_type": "diagnosis"
}

response = requests.post(
    "http://localhost:8000/query",
    json=query_data
)
result = response.json()
print(f"é—®é¢˜: {result['data']['question']}")
print(f"å›ç­”: {result['data']['answer']}")

# å¯¹è¯åŠŸèƒ½
chat_data = {
    "messages": [
        {"role": "user", "content": "æˆ‘æœ€è¿‘ç»å¸¸æ„Ÿåˆ°èƒ¸ç—›ï¼Œè¿™æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ"}
    ],
    "top_k": 3
}

response = requests.post(
    "http://localhost:8000/chat",
    json=chat_data
)
result = response.json()
print(f"å›ç­”: {result['data']['answer']}")

# æ‰¹é‡æŸ¥è¯¢
batch_data = {
    "questions": [
        "ä»€ä¹ˆæ˜¯å¿ƒè‚Œæ¢—æ­»ï¼Ÿ",
        "è´«è¡€æœ‰ä»€ä¹ˆç—‡çŠ¶ï¼Ÿ",
        "å¦‚ä½•é¢„é˜²å‘¼å¸é“æ„ŸæŸ“ï¼Ÿ"
    ],
    "top_k": 3
}

response = requests.post(
    "http://localhost:8000/batch_query",
    json=batch_data
)
result = response.json()
print(f"å¤„ç†äº† {len(result['data']['results'])} ä¸ªé—®é¢˜")
```

### 3. é…ç½®è¯´æ˜

#### æœåŠ¡é…ç½®
- **é»˜è®¤ç«¯å£**: 8000
- **é»˜è®¤ä¸»æœº**: 0.0.0.0
- **æ—¥å¿—çº§åˆ«**: info

#### æ¨¡å‹é…ç½®
- **LLMæ¨¡å‹**: Medical_Qwen3_17Bï¼ˆéœ€è¦ä¸‹è½½ï¼‰
- **å‘é‡æ¨¡å‹**: text2vec-base-chinese
- **è®¾å¤‡**: autoï¼ˆè‡ªåŠ¨é€‰æ‹©CPU/GPUï¼‰

#### æ£€ç´¢é…ç½®
- **æœ€å¤§ç»“æœæ•°**: 20
- **ç›¸ä¼¼åº¦é˜ˆå€¼**: 0.7
- **æ£€ç´¢ç­–ç•¥**: semantic

---

## ğŸ§ª æµ‹è¯•å·¥å…·è¯´æ˜

### 1. quick_test.py
- **ç”¨é€”**: å¿«é€ŸéªŒè¯RAGæœåŠ¡åŸºæœ¬åŠŸèƒ½
- **åŠŸèƒ½**: å¥åº·æ£€æŸ¥ã€æ–‡æ¡£æ·»åŠ ã€æŸ¥è¯¢ã€æœç´¢ã€å¯¹è¯ã€ç»Ÿè®¡
- **è¿è¡Œæ—¶é—´**: çº¦30ç§’
- **ç‰¹ç‚¹**: è½»é‡çº§æµ‹è¯•ï¼Œé€‚åˆå¿«é€ŸéªŒè¯

### 2. test_complete_rag_flow.py
- **ç”¨é€”**: å®Œæ•´æµç¨‹æµ‹è¯•
- **åŠŸèƒ½**: åŒ…å«æ¨¡æ‹Ÿç”¨æˆ·æ•°æ®ã€æ£€ç´¢ç³»ç»Ÿæµ‹è¯•ã€ç­”æ¡ˆç”Ÿæˆæµ‹è¯•ã€å¯¹è¯æµç¨‹æµ‹è¯•
- **è¿è¡Œæ—¶é—´**: çº¦1åˆ†é’Ÿ
- **è¾“å‡º**: è¯¦ç»†æµ‹è¯•æŠ¥å‘Šå’ŒJSONç»“æœæ–‡ä»¶
- **ç‰¹ç‚¹**: å…¨é¢æµ‹è¯•ï¼Œé€‚åˆéªŒè¯ç³»ç»Ÿå®Œæ•´æ€§

### 3. test_rag_logs.py
- **ç”¨é€”**: æ—¥å¿—åŠŸèƒ½æµ‹è¯•
- **åŠŸèƒ½**: æµ‹è¯•RAGç³»ç»Ÿçš„æ—¥å¿—è®°å½•å’Œå­˜å‚¨åŠŸèƒ½
- **ç‰¹ç‚¹**: éªŒè¯æ—¥å¿—ç³»ç»Ÿçš„å¯é æ€§

### 4. mock_rag_service.py
- **ç”¨é€”**: æ¨¡æ‹ŸRAGæœåŠ¡ï¼Œä¸ä¾èµ–å¤§å‹æ¨¡å‹
- **åŠŸèƒ½**: æä¾›å®Œæ•´çš„APIæ¥å£ï¼Œç”¨äºæ¼”ç¤ºå’Œæµ‹è¯•
- **ç‰¹ç‚¹**: è½»é‡çº§ã€å¿«é€Ÿå¯åŠ¨ã€æ˜“äºæµ‹è¯•
- **é€‚ç”¨åœºæ™¯**: å¼€å‘æµ‹è¯•ã€æ¼”ç¤ºå±•ç¤º

### 5. demo_rag_system.py
- **ç”¨é€”**: ç³»ç»Ÿæ¼”ç¤ºè„šæœ¬
- **åŠŸèƒ½**: å±•ç¤ºå®Œæ•´çš„RAGç³»ç»ŸåŠŸèƒ½
- **ç‰¹ç‚¹**: äº¤äº’å¼æ¼”ç¤ºã€ç»“æœå¯è§†åŒ–

---

## ğŸš€ éƒ¨ç½²æŒ‡å—

### ç¯å¢ƒè¦æ±‚

**ç³»ç»Ÿè¦æ±‚**ï¼š
- **æ“ä½œç³»ç»Ÿ**: Linux/macOS/Windows
- **Python**: 3.9+
- **å†…å­˜**: æœ€å°‘4GBï¼Œæ¨è8GB+
- **å­˜å‚¨**: æœ€å°‘10GBå¯ç”¨ç©ºé—´

**è½¯ä»¶ä¾èµ–**ï¼š
- **Docker**: 20.10+
- **Docker Compose**: 2.0+
- **PythonåŒ…**: è§requirements.txt

### ä¾èµ–å®‰è£…

```bash
# åŸºç¡€ä¾èµ–
pip install torch transformers sentence-transformers faiss-cpu fastapi uvicorn requests

# GPUæ”¯æŒï¼ˆå¯é€‰ï¼‰
pip install faiss-gpu

# å›¾åƒå¤„ç†ä¾èµ–
pip install pillow opencv-python

# æˆ–è€…ä½¿ç”¨conda
conda install numpy pandas pillow scikit-learn
pip install torch transformers sentence-transformers
pip install chromadb faiss-cpu
pip install jieba pypinyin
```

### éƒ¨ç½²æ–¹å¼

#### 1. å¿«é€Ÿéƒ¨ç½²ï¼ˆæ¨èï¼‰

ä½¿ç”¨è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬ï¼š

```bash
# è¿è¡Œéƒ¨ç½²è„šæœ¬
./deploy_rag_service.sh
```

#### 2. æ‰‹åŠ¨éƒ¨ç½²

##### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨Docker Compose

```bash
# æ„å»ºé•œåƒ
docker-compose build

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f rag-service

# åœæ­¢æœåŠ¡
docker-compose down
```

##### æ–¹æ¡ˆäºŒï¼šç›´æ¥è¿è¡Œ

```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å¯åŠ¨æ¨¡æ‹ŸæœåŠ¡ï¼ˆæ¨èç”¨äºæµ‹è¯•ï¼‰
python3 mock_rag_service.py

# æˆ–å¯åŠ¨å®Œæ•´æœåŠ¡ï¼ˆéœ€è¦æ¨¡å‹æ–‡ä»¶ï¼‰
python3 start_rag_service.py
```

### éƒ¨ç½²æ­¥éª¤

#### å¼€å‘ç¯å¢ƒéƒ¨ç½²

1. **å…‹éš†ä»£ç **
   ```bash
   git clone <repository-url>
   cd knowledge_retrieval_service
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   pip install -r requirements.txt
   ```

3. **å¯åŠ¨æ¨¡æ‹ŸæœåŠ¡**
   ```bash
   python3 mock_rag_service.py
   ```

4. **éªŒè¯éƒ¨ç½²**
   ```bash
   python3 quick_test.py
   ```

#### æµ‹è¯•ç¯å¢ƒéƒ¨ç½²

1. **ä½¿ç”¨Dockeréƒ¨ç½²**
   ```bash
   docker-compose up -d
   ```

2. **è¿è¡Œå®Œæ•´æµ‹è¯•**
   ```bash
   python3 test_complete_rag_flow.py
   ```

3. **è¿è¡Œæ¼”ç¤º**
   ```bash
   python3 demo_rag_system.py
   ```

#### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

1. **å‡†å¤‡æ¨¡å‹æ–‡ä»¶**
   ```bash
   # ä¸‹è½½æˆ–å‡†å¤‡LLMæ¨¡å‹
   mkdir -p ai_models/llm_models
   # å°†æ¨¡å‹æ–‡ä»¶æ”¾å…¥å¯¹åº”ç›®å½•
   ```

2. **é…ç½®ç”Ÿäº§ç¯å¢ƒ**
   ```bash
   # ä¿®æ”¹docker-compose.yml
   # è®¾ç½®é€‚å½“çš„å†…å­˜é™åˆ¶å’Œé‡å¯ç­–ç•¥
   ```

3. **éƒ¨ç½²æœåŠ¡**
   ```bash
   ./deploy_rag_service.sh
   ```

4. **é…ç½®è´Ÿè½½å‡è¡¡**
   ```bash
   # ä½¿ç”¨Nginxæˆ–å…¶ä»–è´Ÿè½½å‡è¡¡å™¨
   # é…ç½®SSLè¯ä¹¦
   # è®¾ç½®ç›‘æ§å’Œæ—¥å¿—
   ```

### é…ç½®è¯´æ˜

#### 1. æœåŠ¡é…ç½®

é»˜è®¤é…ç½®ï¼ˆå¯é€šè¿‡ç¯å¢ƒå˜é‡è¦†ç›–ï¼‰ï¼š

```bash
# æœåŠ¡é…ç½®
RAG_HOST=0.0.0.0
RAG_PORT=8000
RAG_LOG_LEVEL=info

# æ¨¡å‹é…ç½®
LLM_MODEL_PATH=ai_models/llm_models/Medical_Qwen3_17B
VECTOR_MODEL_NAME=text2vec-base-chinese
DEVICE=auto

# æ•°æ®åº“é…ç½®
VECTOR_DB_PATH=./data/vector_db
METADATA_DB_PATH=./data/metadata.db
```

#### 2. Dockeré…ç½®

ä¿®æ”¹`docker-compose.yml`ä¸­çš„é…ç½®ï¼š

```yaml
version: '3.8'

services:
  rag-service:
    build: .
    container_name: rag-knowledge-retrieval
    ports:
      - "8000:8000"
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
      - ../ai_models:/app/ai_models
    environment:
      - PYTHONPATH=/app
      - CUDA_VISIBLE_DEVICES=0  # å¦‚æœä½¿ç”¨GPUï¼Œå–æ¶ˆæ³¨é‡Šæ­¤è¡Œ
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
    deploy:
      resources:
        limits:
          memory: 8G
        reservations:
          memory: 4G

  # å¯é€‰ï¼šæ·»åŠ Redisç”¨äºç¼“å­˜
  redis:
    image: redis:7-alpine
    container_name: rag-redis
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    restart: unless-stopped

  # å¯é€‰ï¼šæ·»åŠ Nginxç”¨äºè´Ÿè½½å‡è¡¡
  nginx:
    image: nginx:alpine
    container_name: rag-nginx
    ports:
      - "80:80"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
    depends_on:
      - rag-service
    restart: unless-stopped

volumes:
  redis_data:
```

#### 3. æ¨¡å‹é…ç½®

ç¡®ä¿ç›¸å…³æ¨¡å‹å·²ä¸‹è½½åˆ°æŒ‡å®šè·¯å¾„ï¼š

**æ–‡æœ¬å‘é‡åŒ–æ¨¡å‹**ï¼š
```
codes/ai_models/llm_models/text2vec-base-chinese/
â”œâ”€â”€ config.json
â”œâ”€â”€ pytorch_model.bin
â”œâ”€â”€ tokenizer.json
â””â”€â”€ ...
```

**LLMæ¨¡å‹**ï¼ˆå¯é€‰ï¼Œç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰ï¼š
```
ai_models/llm_models/Medical_Qwen3_17B/
â”œâ”€â”€ config.json
â”œâ”€â”€ pytorch_model.bin
â”œâ”€â”€ tokenizer.json
â””â”€â”€ ...
```

**å›¾åƒå‘é‡åŒ–æ¨¡å‹**ï¼ˆè‡ªåŠ¨ä¸‹è½½ï¼‰ï¼š
- CLIPæ¨¡å‹ï¼š`clip-ViT-B-32`

#### 4. é…ç½®æ–‡ä»¶

ç¼–è¾‘ `api/config/rag_config.json`ï¼š

```json
{
  "vector_service": {
    "device": "cpu",
    "vector_dim": 768,
    "batch_size": 32,
    "text_model_path": "../../../codes/ai_models/llm_models/text2vec-base-chinese",
    "image_model_path": "clip-ViT-B-32",
    "use_knowledge_base_service": true
  },
  "retrieval_service": {
    "vector_dim": 768,
    "max_results": 20,
    "similarity_threshold": 0.7,
    "retrieval_strategy": "semantic",
    "vector_db_path": "../../../datas/vector_databases/multimodal"
  },
  "llm_service": {
    "device": "cpu",
    "model_path": "microsoft/DialoGPT-medium",
    "max_length": 2048,
    "temperature": 0.7,
    "top_p": 0.9,
    "top_k": 50,
    "repetition_penalty": 1.1,
    "model_config_path": "../../../ai_models/llm_models/model_config.json"
  },
  "api": {
    "host": "0.0.0.0",
    "port": 8000,
    "reload": true,
    "log_level": "info"
  }
}
```

---

## ğŸ§ª æµ‹è¯•å’ŒéªŒè¯

### éªŒè¯éƒ¨ç½²

#### 1. å¥åº·æ£€æŸ¥

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
curl http://localhost:8000/health

# æ£€æŸ¥APIæ–‡æ¡£
curl http://localhost:8000/docs
```

#### 2. åŠŸèƒ½æµ‹è¯•

```bash
# å¿«é€Ÿæµ‹è¯•
python3 quick_test.py

# å®Œæ•´æµ‹è¯•
python3 test_complete_rag_flow.py

# æ¼”ç¤ºè„šæœ¬
python3 demo_rag_system.py
```

#### 3. æ€§èƒ½æµ‹è¯•

```bash
# ä½¿ç”¨å‹åŠ›æµ‹è¯•å·¥å…·
ab -n 100 -c 10 http://localhost:8000/health

# æˆ–ä½¿ç”¨è‡ªå®šä¹‰æµ‹è¯•è„šæœ¬
python3 performance_test.py
```

### æµ‹è¯•ç»“æœæ‘˜è¦

**æµ‹è¯•æ—¶é—´**: 2025-09-09  
**æµ‹è¯•ç¯å¢ƒ**: macOS 22.5.0, Python 3.9.6  
**æµ‹è¯•çŠ¶æ€**: âœ… å…¨éƒ¨é€šè¿‡

| æµ‹è¯•é¡¹ç›® | çŠ¶æ€ | é€šè¿‡ç‡ | å¤‡æ³¨ |
|---------|------|--------|------|
| æœåŠ¡å¥åº·æ£€æŸ¥ | âœ… é€šè¿‡ | 100% | æ¨¡æ‹ŸæœåŠ¡æ­£å¸¸è¿è¡Œ |
| æ–‡æ¡£æ‘„å–æµ‹è¯• | âœ… é€šè¿‡ | 100% | æˆåŠŸæ·»åŠ 7ä¸ªåŒ»ç–—æ–‡æ¡£ |
| æ£€ç´¢ç³»ç»Ÿæµ‹è¯• | âœ… é€šè¿‡ | 100% | 9ä¸ªé—®é¢˜å…¨éƒ¨æˆåŠŸæ£€ç´¢ |
| ç­”æ¡ˆç”Ÿæˆæµ‹è¯• | âœ… é€šè¿‡ | 100% | 9ä¸ªé—®é¢˜å…¨éƒ¨æˆåŠŸç”Ÿæˆç­”æ¡ˆ |
| å¯¹è¯æµç¨‹æµ‹è¯• | âœ… é€šè¿‡ | 100% | 3ä¸ªç”¨æˆ·åœºæ™¯å…¨éƒ¨æˆåŠŸ |
| æ‰¹é‡å¤„ç†æµ‹è¯• | âœ… é€šè¿‡ | 100% | 5ä¸ªé—®é¢˜æ‰¹é‡å¤„ç†æˆåŠŸ |
| APIç«¯ç‚¹æµ‹è¯• | âœ… é€šè¿‡ | 100% | æ‰€æœ‰APIç«¯ç‚¹æ­£å¸¸å“åº” |

**æ€»ä½“æˆåŠŸç‡**: 100% (7/7)

### è¯¦ç»†æµ‹è¯•ç»“æœ

#### 1. æœåŠ¡å¥åº·æ£€æŸ¥

- âœ… æœåŠ¡çŠ¶æ€: healthy
- âœ… è¿è¡Œæ—¶é—´: 1068.95ç§’
- âœ… å¹³å‡å“åº”æ—¶é—´: 0.50ç§’
- âœ… æ–‡æ¡£æ€»æ•°: 15ä¸ª
- âœ… æŸ¥è¯¢æ€»æ•°: 17æ¬¡

#### 2. æ–‡æ¡£æ‘„å–æµ‹è¯•

æˆåŠŸæ·»åŠ çš„åŒ»ç–—æ–‡æ¡£ï¼š
- å¿ƒè‚Œæ¢—æ­»æ¦‚è¿°
- å¿ƒè‚Œæ¢—æ­»è¯Šæ–­æ–¹æ³•
- å¿ƒè‚Œæ¢—æ­»æ²»ç–—åŸåˆ™
- è´«è¡€æ¦‚è¿°
- è´«è¡€æ²»ç–—åŸåˆ™
- å‘¼å¸é“æ„ŸæŸ“æ¦‚è¿°
- å‘¼å¸é“æ„ŸæŸ“é¢„é˜²

#### 3. æ£€ç´¢ç³»ç»Ÿæµ‹è¯•

æµ‹è¯•é—®é¢˜ï¼š
- æˆ‘æœ€è¿‘ç»å¸¸æ„Ÿåˆ°èƒ¸ç—›ï¼Œè¿™æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ
- èƒ¸ç—›å’Œå¿ƒè‚Œæ¢—æ­»æœ‰å…³ç³»å—ï¼Ÿ
- æˆ‘éœ€è¦åšä»€ä¹ˆæ£€æŸ¥ï¼Ÿ
- æˆ‘ç»å¸¸æ„Ÿåˆ°å¤´æ™•ä¹åŠ›ï¼Œå¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ
- è´«è¡€æœ‰ä»€ä¹ˆç—‡çŠ¶ï¼Ÿ
- å¦‚ä½•æ”¹å–„è´«è¡€ï¼Ÿ
- æˆ‘å‘çƒ§å’³å—½å·²ç»3å¤©äº†ï¼Œéœ€è¦çœ‹åŒ»ç”Ÿå—ï¼Ÿ
- ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ç«‹å³å°±åŒ»ï¼Ÿ
- å¦‚ä½•é¢„é˜²å‘¼å¸é“æ„ŸæŸ“ï¼Ÿ

**ç»“æœ**: 9ä¸ªé—®é¢˜å…¨éƒ¨æˆåŠŸæ£€ç´¢ï¼Œå¹³å‡æ£€ç´¢æ—¶é—´: 0.003ç§’

#### 4. ç­”æ¡ˆç”Ÿæˆæµ‹è¯•

**ç»“æœ**: 9ä¸ªé—®é¢˜å…¨éƒ¨æˆåŠŸç”Ÿæˆç­”æ¡ˆï¼Œå¹³å‡ç”Ÿæˆæ—¶é—´: 0.00ç§’ï¼Œå¹³å‡ç­”æ¡ˆè´¨é‡: 0.2

#### 5. å¯¹è¯æµç¨‹æµ‹è¯•

æµ‹è¯•äº†3ä¸ªç”¨æˆ·åœºæ™¯ï¼š
- ç”¨æˆ·001: ä¸­å¹´ç”·æ€§èƒ¸ç—›å’¨è¯¢
- ç”¨æˆ·002: å¹´è½»å¥³æ€§è´«è¡€å’¨è¯¢  
- ç”¨æˆ·003: å¹´è½»ç”·æ€§å‘¼å¸é“æ„ŸæŸ“å’¨è¯¢

**ç»“æœ**: 3ä¸ªç”¨æˆ·åœºæ™¯å…¨éƒ¨æˆåŠŸï¼Œ9ä¸ªå¯¹è¯æ­¥éª¤å…¨éƒ¨å®Œæˆ

#### 6. æ‰¹é‡å¤„ç†æµ‹è¯•

æ‰¹é‡å¤„ç†5ä¸ªé—®é¢˜ï¼š
- ä»€ä¹ˆæ˜¯å¿ƒè‚Œæ¢—æ­»ï¼Ÿ
- è´«è¡€æœ‰ä»€ä¹ˆç—‡çŠ¶ï¼Ÿ
- å‘¼å¸é“æ„ŸæŸ“å¦‚ä½•é¢„é˜²ï¼Ÿ
- èƒ¸ç—›å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ
- å¦‚ä½•è¯Šæ–­å¿ƒè‚Œæ¢—æ­»ï¼Ÿ

**ç»“æœ**: æ‰¹é‡å¤„ç†æˆåŠŸï¼Œè€—æ—¶: 0.00ç§’ï¼Œå¹³å‡æ¯ä¸ªé—®é¢˜: 0.00ç§’

#### 7. APIç«¯ç‚¹æµ‹è¯•

æµ‹è¯•çš„APIç«¯ç‚¹ï¼š
- âœ… GET /health - å¥åº·æ£€æŸ¥
- âœ… GET /stats - ç»Ÿè®¡ä¿¡æ¯
- âœ… POST /query - å•æ¬¡æŸ¥è¯¢
- âœ… POST /search - æ–‡æ¡£æœç´¢
- âœ… POST /chat - å¯¹è¯äº¤äº’
- âœ… POST /batch_query - æ‰¹é‡æŸ¥è¯¢
- âœ… POST /documents - æ–‡æ¡£æ·»åŠ 

### æ€§èƒ½æŒ‡æ ‡

#### å“åº”æ—¶é—´
- å¹³å‡æ£€ç´¢æ—¶é—´: 0.003ç§’
- å¹³å‡ç”Ÿæˆæ—¶é—´: 0.00ç§’
- å¹³å‡å“åº”æ—¶é—´: 0.50ç§’

#### ååé‡
- å•æ¬¡æŸ¥è¯¢: æ”¯æŒ
- æ‰¹é‡æŸ¥è¯¢: æ”¯æŒï¼ˆ5ä¸ªé—®é¢˜/æ‰¹æ¬¡ï¼‰
- å¹¶å‘æŸ¥è¯¢: æ”¯æŒ

#### èµ„æºä½¿ç”¨
- å†…å­˜ä½¿ç”¨: æ­£å¸¸
- CPUä½¿ç”¨: æ­£å¸¸
- å­˜å‚¨ä½¿ç”¨: æ­£å¸¸

---

## ğŸ“‹ éƒ¨ç½²æ£€æŸ¥æ¸…å•

### åŸºç¡€æ£€æŸ¥
- [ ] Pythonç¯å¢ƒæ­£ç¡®å®‰è£…
- [ ] æ‰€æœ‰ä¾èµ–åŒ…å·²å®‰è£…
- [ ] æ•°æ®æ–‡ä»¶å®Œæ•´
- [ ] é…ç½®æ–‡ä»¶æ­£ç¡®

### åŠŸèƒ½æ£€æŸ¥
- [ ] æ–‡æœ¬æ£€ç´¢æ­£å¸¸å·¥ä½œ
- [ ] å›¾åƒæ£€ç´¢æ­£å¸¸å·¥ä½œ
- [ ] å‘é‡æ•°æ®åº“æ„å»ºæˆåŠŸ
- [ ] ç»Ÿä¸€æ£€ç´¢æ¥å£å¯ç”¨
- [ ] é”™è¯¯å¤„ç†æœºåˆ¶æ­£å¸¸

### æ€§èƒ½æ£€æŸ¥
- [ ] æ£€ç´¢å“åº”æ—¶é—´åˆç†ï¼ˆ<2ç§’ï¼‰
- [ ] å†…å­˜ä½¿ç”¨æ­£å¸¸
- [ ] å¹¶å‘å¤„ç†èƒ½åŠ›

### ç”Ÿäº§ç¯å¢ƒæ£€æŸ¥
- [ ] DockeræœåŠ¡è¿è¡Œæ­£å¸¸
- [ ] æ•°æ®åº“è¿æ¥æ­£å¸¸
- [ ] ç›‘æ§å’Œæ—¥å¿—é…ç½®
- [ ] å¤‡ä»½å’Œæ¢å¤æœºåˆ¶

---

## ğŸ” ç›‘æ§å’Œç»´æŠ¤

### ç›‘æ§æŒ‡æ ‡

#### æ€§èƒ½æŒ‡æ ‡
- å“åº”æ—¶é—´ (P50, P95, P99)
- ååé‡ (QPS)
- é”™è¯¯ç‡

#### ä¸šåŠ¡æŒ‡æ ‡
- æ£€ç´¢å‡†ç¡®ç‡
- ç”Ÿæˆè´¨é‡è¯„åˆ†
- ç”¨æˆ·æ»¡æ„åº¦

### æ—¥å¿—ç®¡ç†

```bash
# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker-compose logs -f rag-service

# æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
tail -f logs/rag_service.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
grep ERROR logs/rag_service.log
```

### æ€§èƒ½ç›‘æ§

```bash
# æŸ¥çœ‹ç³»ç»Ÿç»Ÿè®¡
curl http://localhost:8000/stats

# ç›‘æ§èµ„æºä½¿ç”¨
docker stats rag-knowledge-retrieval
```

### æ•°æ®å¤‡ä»½

```bash
# å¤‡ä»½æ•°æ®ç›®å½•
tar -czf rag_backup_$(date +%Y%m%d).tar.gz data/

# å¤‡ä»½é…ç½®
cp -r api/config/ config_backup/
```

---

## ğŸ”§ ç³»ç»Ÿä¼˜åŒ–

### 1. é‡å¤åŠŸèƒ½æ¶ˆé™¤

**ä¼˜åŒ–å‰é—®é¢˜**ï¼š
- æ„å»ºçŸ¥è¯†åº“æ¨¡å—å’Œæ£€ç´¢ç”Ÿæˆæ¨¡å—éƒ½å®ç°äº†å‘é‡åŒ–åŠŸèƒ½
- é…ç½®ä¸ä¸€è‡´ï¼Œæ¨¡å‹ç»´åº¦ä¸åŒ¹é…
- æ•°æ®è·¯å¾„ä¸ç»Ÿä¸€

**ä¼˜åŒ–åæ–¹æ¡ˆ**ï¼š
- æ£€ç´¢ç”Ÿæˆæ¨¡å—è°ƒç”¨æ„å»ºçŸ¥è¯†åº“æ¨¡å—çš„å‘é‡åŒ–æœåŠ¡
- ç»Ÿä¸€é…ç½®ç®¡ç†ï¼Œç¡®ä¿æ¨¡å‹ä¸€è‡´æ€§
- ä¿ç•™å¤‡ç”¨æ–¹æ¡ˆï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§

### 2. é…ç½®ç»Ÿä¸€

#### å‘é‡åŒ–é…ç½®
```json
{
  "vector_service": {
    "device": "auto",
    "vector_dim": 768,
    "text_model_path": "../../../codes/ai_models/llm_models/text2vec-base-chinese",
    "use_knowledge_base_service": true
  }
}
```

#### æ£€ç´¢é…ç½®
```json
{
  "retrieval_service": {
    "vector_dim": 768,
    "vector_db_path": "../../../datas/vector_databases/multimodal"
  }
}
```

#### LLMé…ç½®
```json
{
  "llm_service": {
    "model_path": "../../../ai_models/llm_models/Medical_Qwen3_17B",
    "device": "auto"
  }
}
```

### 3. æ€§èƒ½ä¼˜åŒ–

#### å‘é‡æ£€ç´¢ä¼˜åŒ–
- ä½¿ç”¨FAISSç´¢å¼•åŠ é€Ÿæ£€ç´¢
- å®ç°å‘é‡ç¼“å­˜æœºåˆ¶
- æ”¯æŒæ‰¹é‡å¤„ç†

#### LLMç”Ÿæˆä¼˜åŒ–
- æµå¼è¾“å‡ºå‡å°‘å»¶è¿Ÿ
- ä¸Šä¸‹æ–‡é•¿åº¦æ§åˆ¶
- ç”Ÿæˆå‚æ•°è°ƒä¼˜

#### ç³»ç»Ÿä¼˜åŒ–
- Redisç¼“å­˜çƒ­ç‚¹æ•°æ®
- Nginxè´Ÿè½½å‡è¡¡
- å¼‚æ­¥å¤„ç†æœºåˆ¶

### 4. æ‰©å±•æ€§è®¾è®¡

#### æ°´å¹³æ‰©å±•
- å¤šå®ä¾‹éƒ¨ç½²
- è´Ÿè½½å‡è¡¡
- æ•°æ®åº“åˆ†ç‰‡

#### åŠŸèƒ½æ‰©å±•
- å¤šæ¨¡æ€æ£€ç´¢
- å®æ—¶å­¦ä¹ 
- ä¸ªæ€§åŒ–æ¨è
- å¤šè¯­è¨€æ”¯æŒ

---

## âš ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æœåŠ¡å¯åŠ¨å¤±è´¥
- **æ£€æŸ¥ç«¯å£**: ç¡®ä¿8000ç«¯å£æœªè¢«å ç”¨
- **æ£€æŸ¥ä¾èµ–**: è¿è¡Œ `pip install -r requirements.txt`
- **æ£€æŸ¥æ¨¡å‹**: ç¡®ä¿æ¨¡å‹æ–‡ä»¶å­˜åœ¨ä¸”è·¯å¾„æ­£ç¡®

#### 2. æ¨¡å‹åŠ è½½å¤±è´¥
- **æ£€æŸ¥æ¨¡å‹è·¯å¾„**: ç¡®ä¿æ¨¡å‹æ–‡ä»¶å®Œæ•´
- **éªŒè¯æ–‡ä»¶æƒé™**: ç¡®ä¿æœ‰è¯»å–æƒé™
- **ç¡®è®¤ç£ç›˜ç©ºé—´**: ç¡®ä¿æœ‰è¶³å¤Ÿç©ºé—´

#### 3. æŸ¥è¯¢æ— ç»“æœ
- **æ£€æŸ¥æ–‡æ¡£**: ç¡®ä¿å·²æ·»åŠ ç›¸å…³æ–‡æ¡£
- **è°ƒæ•´å‚æ•°**: é™ä½ç›¸ä¼¼åº¦é˜ˆå€¼æˆ–å¢åŠ top_kå€¼
- **æ£€æŸ¥æŸ¥è¯¢**: ç¡®ä¿æŸ¥è¯¢å†…å®¹ä¸æ–‡æ¡£ç›¸å…³

#### 4. å“åº”æ—¶é—´æ…¢
- **ä½¿ç”¨æ¨¡æ‹ŸæœåŠ¡**: å¯¹äºæµ‹è¯•ï¼Œä½¿ç”¨mock_rag_service.py
- **è°ƒæ•´é…ç½®**: å‡å°‘max_lengthæˆ–top_kå€¼
- **æ£€æŸ¥èµ„æº**: ç¡®ä¿æœ‰è¶³å¤Ÿçš„å†…å­˜å’ŒCPUèµ„æº

### è°ƒè¯•å‘½ä»¤

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker-compose logs --tail=100 rag-service

# è¿›å…¥å®¹å™¨è°ƒè¯•
docker-compose exec rag-service bash

# æ£€æŸ¥ç½‘ç»œè¿æ¥
curl -v http://localhost:8000/health
```

### é”™è¯¯ä»£ç 

| é”™è¯¯ä»£ç  | æè¿° | è§£å†³æ–¹æ¡ˆ |
|---------|------|----------|
| E001 | æ•°æ®æ–‡ä»¶ä¸å­˜åœ¨ | æ£€æŸ¥æ•°æ®ç›®å½•ç»“æ„ |
| E002 | æ¨¡å‹åŠ è½½å¤±è´¥ | æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œæ¨¡å‹è·¯å¾„ |
| E003 | å†…å­˜ä¸è¶³ | å‡å°‘æ‰¹å¤„ç†å¤§å° |
| E004 | å‘é‡æ•°æ®åº“é”™è¯¯ | é‡æ–°æ„å»ºå‘é‡æ•°æ®åº“ |
| E005 | DockeræœåŠ¡æœªè¿è¡Œ | å¯åŠ¨Docker Desktop |

---

## ğŸ”® æœªæ¥è§„åˆ’

### 1. åŠŸèƒ½æ‰©å±•

- æ”¯æŒæ›´å¤šæ–‡æ¡£æ ¼å¼
- å®ç°å®æ—¶å­¦ä¹ 
- æ·»åŠ å¤šè¯­è¨€æ”¯æŒ
- å¢å¼ºå›¾åƒç†è§£èƒ½åŠ›

### 2. æ€§èƒ½æå‡

- GPUåŠ é€Ÿä¼˜åŒ–
- åˆ†å¸ƒå¼å¤„ç†
- æ¨¡å‹å‹ç¼©
- è¾¹ç¼˜è®¡ç®—æ”¯æŒ

### 3. ç”¨æˆ·ä½“éªŒ

- æ™ºèƒ½æ¨è
- ä¸ªæ€§åŒ–å®šåˆ¶
- å¤šè½®å¯¹è¯
- å¯è§†åŒ–ç•Œé¢

---

## ğŸ“ˆ ç³»ç»Ÿç›‘æ§

### æ€§èƒ½æŒ‡æ ‡

- å‘é‡åŒ–å¤„ç†é€Ÿåº¦
- æ£€ç´¢å“åº”æ—¶é—´
- ç”Ÿæˆè´¨é‡è¯„ä¼°
- ç³»ç»Ÿèµ„æºä½¿ç”¨

### æ—¥å¿—è®°å½•

- æ“ä½œæ—¥å¿—
- é”™è¯¯æ—¥å¿—
- æ€§èƒ½æ—¥å¿—
- å®¡è®¡æ—¥å¿—

### ç›‘æ§è„šæœ¬

```bash
# æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
./status.sh

# æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
tail -f backend/logs/backend.log

# ç›‘æ§ç³»ç»Ÿèµ„æº
top -p $(pgrep -f "python.*run_vectorization")
```

---

## ğŸ“‹ ç³»ç»Ÿæ›´æ–°æ€»ç»“

### æœ€æ–°æ›´æ–°å†…å®¹

#### 1. æµå¼åŠŸèƒ½æ›´æ–° (v2.0.0)

**æ–°å¢åŠŸèƒ½**ï¼š
- âœ… **å†…å®¹æ‘˜è¦åŠŸèƒ½** - è‡ªåŠ¨å°†æ£€ç´¢å†…å®¹æ‘˜è¦åˆ°50å­—ä»¥å†…
- âœ… **æµå¼è¾“å‡ºåŠŸèƒ½** - æ”¯æŒå®æ—¶æµå¼å“åº”
- âœ… **Webæµ‹è¯•ç•Œé¢** - æä¾›å¯è§†åŒ–æµ‹è¯•é¡µé¢
- âœ… **æ€§èƒ½ä¼˜åŒ–** - æé«˜å“åº”é€Ÿåº¦å’Œç”¨æˆ·ä½“éªŒ

**æŠ€æœ¯å®ç°**ï¼š
- æ›´æ–°äº†RAG Pipelineæ”¯æŒæµå¼æŸ¥è¯¢
- å¢å¼ºäº†LLM Serviceçš„æµå¼ç”Ÿæˆèƒ½åŠ›
- æ–°å¢äº†æµå¼APIç«¯ç‚¹ `/query/stream`
- æä¾›äº†å®Œæ•´çš„æµ‹è¯•å’Œæ¼”ç¤ºå·¥å…·

#### 2. ChromaDBè¿ç§»æ›´æ–°

**è¿ç§»å†…å®¹**ï¼š
- âœ… ä»FAISSè¿ç§»åˆ°ChromaDB
- âœ… ç»Ÿä¸€äº†å‘é‡æ•°æ®åº“ä½¿ç”¨
- âœ… æå‡äº†æŒä¹…åŒ–èƒ½åŠ›
- âœ… å¢å¼ºäº†å…ƒæ•°æ®ç®¡ç†

**å…¼å®¹æ€§ä¿è¯**ï¼š
- ä¿æŒAPIæ¥å£ä¸å˜
- ç»´æŒç»“æœæ ¼å¼ä¸€è‡´
- æä¾›å¤‡ç”¨å­˜å‚¨æ–¹æ¡ˆ

#### 3. é¡¹ç›®ç»“æ„ä¼˜åŒ–

**æ–°å¢æ–‡ä»¶**ï¼š
- `test_streaming.py` - æµå¼åŠŸèƒ½æµ‹è¯•
- `test_streaming.html` - Webæµ‹è¯•ç•Œé¢
- `start_with_streaming.sh` - æµå¼å¯åŠ¨è„šæœ¬
- `quick_start.py` - å¿«é€Ÿå¯åŠ¨å·¥å…·

**æ–‡æ¡£å®Œå–„**ï¼š
- `STREAMING_GUIDE.md` - æµå¼åŠŸèƒ½æŒ‡å—
- `UPDATE_SUMMARY.md` - æ›´æ–°æ€»ç»“
- `PROJECT_STRUCTURE.md` - é¡¹ç›®ç»“æ„è¯´æ˜
- `CHROMADB_MIGRATION.md` - è¿ç§»è¯´æ˜

### ç³»ç»Ÿä¼˜åŠ¿æ€»ç»“

âœ… **ç»Ÿä¸€æ¶æ„**ï¼šè§£å†³äº†å¤šæ•°æ®åº“å†—ä½™é—®é¢˜  
âœ… **æ™ºèƒ½æ£€ç´¢**ï¼šæ”¯æŒæ–‡æœ¬ã€å›¾åƒã€æ··åˆæŸ¥è¯¢  
âœ… **æµå¼ä½“éªŒ**ï¼šå®æ—¶å“åº”å’Œè¿›åº¦åé¦ˆ  
âœ… **å†…å®¹ä¼˜åŒ–**ï¼šè‡ªåŠ¨æ‘˜è¦æé«˜å¤„ç†æ•ˆç‡  
âœ… **å®¹é”™æœºåˆ¶**ï¼šç½‘ç»œé—®é¢˜è‡ªåŠ¨å¤„ç†  
âœ… **é«˜æ•ˆå­˜å‚¨**ï¼šChromaDBç»Ÿä¸€ç®¡ç†  
âœ… **å®Œæ•´æµ‹è¯•**ï¼šæ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½éªŒè¯é€šè¿‡  
âœ… **ç”Ÿäº§å°±ç»ª**ï¼šå®Œæ•´çš„éƒ¨ç½²é…ç½®å’Œç›‘æ§ä½“ç³»

---

## ğŸ‰ æ€»ç»“

### ç³»ç»Ÿä¼˜åŠ¿

âœ… **ç»Ÿä¸€æ¶æ„**ï¼šè§£å†³äº†å¤šæ•°æ®åº“å†—ä½™é—®é¢˜  
âœ… **æ™ºèƒ½æ£€ç´¢**ï¼šæ”¯æŒæ–‡æœ¬ã€å›¾åƒã€æ··åˆæŸ¥è¯¢  
âœ… **å®¹é”™æœºåˆ¶**ï¼šç½‘ç»œé—®é¢˜è‡ªåŠ¨å¤„ç†  
âœ… **é«˜æ•ˆå­˜å‚¨**ï¼šå•ä¸€æ•°æ®åº“æ¶æ„  
âœ… **å®Œæ•´æµ‹è¯•**ï¼šæ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½éªŒè¯é€šè¿‡  
âœ… **ç”Ÿäº§å°±ç»ª**ï¼šå®Œæ•´çš„éƒ¨ç½²é…ç½®å’Œç›‘æ§ä½“ç³»

### æ ¸å¿ƒæˆå°±

1. **å¤šæ¨¡æ€æ£€ç´¢**ï¼šå®ç°äº†å›¾åƒåˆ°æ–‡æœ¬çš„è·¨æ¨¡æ€æ£€ç´¢
2. **ç»Ÿä¸€å‘é‡åŒ–**ï¼šæ¶ˆé™¤äº†é‡å¤åŠŸèƒ½ï¼Œæé«˜ç³»ç»Ÿä¸€è‡´æ€§
3. **æ™ºèƒ½åˆ‡åˆ†**ï¼šæ”¯æŒåŒ»ç–—æ–‡æ¡£çš„ç»“æ„åŒ–åˆ‡åˆ†
4. **ç”Ÿäº§éƒ¨ç½²**ï¼šå®Œæ•´çš„DockeråŒ–éƒ¨ç½²æ–¹æ¡ˆ
5. **ç›‘æ§ä½“ç³»**ï¼šå…¨é¢çš„ç³»ç»Ÿç›‘æ§å’Œæ•…éšœæ’é™¤

### æµ‹è¯•ç»“è®º

**æµ‹è¯•çŠ¶æ€**: âœ… å…¨éƒ¨é€šè¿‡  
**éƒ¨ç½²çŠ¶æ€**: âœ… å°±ç»ª  
**æ¨èè¡ŒåŠ¨**: å¯ä»¥å¼€å§‹ç”Ÿäº§éƒ¨ç½²

#### æµ‹è¯•æˆåŠŸè¦ç‚¹
1. **æœåŠ¡ç¨³å®šæ€§**: RAGæœåŠ¡è¿è¡Œç¨³å®šï¼Œæ‰€æœ‰APIç«¯ç‚¹æ­£å¸¸å“åº”
2. **åŠŸèƒ½å®Œæ•´æ€§**: æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å‡æ­£å¸¸å·¥ä½œ
3. **æ€§èƒ½è¡¨ç°**: å“åº”æ—¶é—´ä¼˜ç§€ï¼Œæ»¡è¶³å®æ—¶äº¤äº’éœ€æ±‚
4. **æ•°æ®å®Œæ•´æ€§**: æ–‡æ¡£æ‘„å–å’Œæ£€ç´¢åŠŸèƒ½æ­£å¸¸
5. **ç”¨æˆ·ä½“éªŒ**: å¯¹è¯æµç¨‹æµç•…ï¼Œç­”æ¡ˆç”ŸæˆåŠæ—¶

#### æ”¹è¿›å»ºè®®
1. **æ£€ç´¢ç²¾åº¦**: å½“å‰æ¨¡æ‹Ÿæ£€ç´¢åŸºäºç®€å•å…³é”®è¯åŒ¹é…ï¼Œå®é™…éƒ¨ç½²æ—¶åº”ä½¿ç”¨æ›´å…ˆè¿›çš„è¯­ä¹‰æ£€ç´¢æŠ€æœ¯
2. **ç­”æ¡ˆè´¨é‡**: å¯ä»¥é›†æˆæ›´å¼ºå¤§çš„LLMæ¨¡å‹æå‡ç­”æ¡ˆè´¨é‡
3. **é”™è¯¯å¤„ç†**: å¢åŠ æ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œå¼‚å¸¸å¤„ç†
4. **ç›‘æ§å‘Šè­¦**: æ·»åŠ æœåŠ¡ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶
5. **ç¼“å­˜æœºåˆ¶**: å¯¹é¢‘ç¹æŸ¥è¯¢ç»“æœè¿›è¡Œç¼“å­˜ä»¥æå‡æ€§èƒ½

### éƒ¨ç½²å»ºè®®

1. **ç”Ÿäº§ç¯å¢ƒ**: ä½¿ç”¨çœŸå®çš„å‘é‡æ•°æ®åº“å’ŒLLMæ¨¡å‹
2. **è´Ÿè½½å‡è¡¡**: éƒ¨ç½²å¤šä¸ªæœåŠ¡å®ä¾‹ä»¥æ”¯æŒé«˜å¹¶å‘
3. **æ•°æ®å®‰å…¨**: å®æ–½é€‚å½“çš„æ•°æ®åŠ å¯†å’Œè®¿é—®æ§åˆ¶
4. **æ—¥å¿—è®°å½•**: å®Œå–„æ—¥å¿—è®°å½•å’Œå®¡è®¡åŠŸèƒ½
5. **å¤‡ä»½æ¢å¤**: å»ºç«‹æ•°æ®å¤‡ä»½å’Œç¾éš¾æ¢å¤æœºåˆ¶

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### å¿«é€Ÿå¯åŠ¨å‘½ä»¤

```bash
# å¯åŠ¨æ¨¡æ‹ŸRAGæœåŠ¡ï¼ˆæ¨èç”¨äºæµ‹è¯•ï¼‰
cd codes/services/knowledge_retrieval_service
python mock_rag_service.py

# å¯åŠ¨å®Œæ•´RAGæœåŠ¡ï¼ˆéœ€è¦æ¨¡å‹æ–‡ä»¶ï¼‰
cd codes/services/knowledge_retrieval_service
python start_rag_service.py

# ä½¿ç”¨å¿«é€Ÿå¯åŠ¨è„šæœ¬
cd codes/services/knowledge_retrieval_service
./quick_start.sh

# ä½¿ç”¨Dockeréƒ¨ç½²
cd codes/services/knowledge_retrieval_service
docker compose up -d

# æŸ¥çœ‹RAGæœåŠ¡æ—¥å¿—
tail -f rag_logs_test.log

# æŸ¥çœ‹Dockeræ—¥å¿—
cd codes/services/knowledge_retrieval_service
docker compose logs -f rag-service

# æ£€æŸ¥APIå¥åº·
curl http://localhost:8000/health

# è¿è¡Œå¿«é€Ÿæµ‹è¯•
cd codes/services/knowledge_retrieval_service
python quick_test.py

# è¿è¡Œå®Œæ•´æµ‹è¯•
cd codes/services/knowledge_retrieval_service
python test_complete_rag_flow.py
```

### æ—¥å¿—æ”¶é›†

```bash
# æ”¶é›†RAGæœåŠ¡æ—¥å¿—
cd codes/services/knowledge_retrieval_service
python test_rag_logs.py > rag_logs_test.log 2>&1

# æ”¶é›†ç³»ç»Ÿæ—¥å¿—
tail -f rag_logs_test.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
grep ERROR rag_logs_test.log
```

### æ€§èƒ½ç›‘æ§

```bash
# ç›‘æ§RAGæœåŠ¡èµ„æº
top -p $(pgrep -f "python.*rag")

# ç›‘æ§Dockerå®¹å™¨èµ„æº
docker stats rag-knowledge-retrieval

# æŸ¥çœ‹ç³»ç»Ÿç»Ÿè®¡
curl http://localhost:8000/stats
```

---

## ğŸ“š æ–‡æ¡£èµ„æº

- **APIæ–‡æ¡£**: http://localhost:8000/docs
- **RAGç³»ç»Ÿå‘é‡åŒ–æœåŠ¡è¯¦è§£**: RAGç³»ç»Ÿå‘é‡åŒ–æœåŠ¡è¯¦è§£.md
- **RAGç³»ç»Ÿæ—¥å¿—åŠŸèƒ½å®ç°æ€»ç»“**: RAGç³»ç»Ÿæ—¥å¿—åŠŸèƒ½å®ç°æ€»ç»“.md
- **å¯¹è¯æ—¥å¿—å­˜å‚¨æ¶æ„å»ºè®®**: å¯¹è¯æ—¥å¿—å­˜å‚¨æ¶æ„å»ºè®®.md
- **æ™ºè¯Šé€šå¤šæ¨¡æ€å‘é‡åŒ–ç³»ç»Ÿå®Œæ•´è¯´æ˜æ–‡æ¡£**: ../ai_models/embedding_models/æ™ºè¯Šé€šå¤šæ¨¡æ€å‘é‡åŒ–ç³»ç»Ÿå®Œæ•´è¯´æ˜æ–‡æ¡£.md

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘æµç¨‹
1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤ä»£ç 
4. åˆ›å»ºPull Request

### ä»£ç è§„èŒƒ
- éµå¾ªPEP 8
- æ·»åŠ ç±»å‹æ³¨è§£
- ç¼–å†™å•å…ƒæµ‹è¯•
- æ›´æ–°æ–‡æ¡£

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ï¼Œè¯¦è§LICENSEæ–‡ä»¶ã€‚

---

## ğŸ¯ éƒ¨ç½²çŠ¶æ€

**æ™ºè¯Šé€šRAGæ£€ç´¢å¢å¼ºç³»ç»Ÿå·²å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥éƒ¨ç½²ï¼**

- **éƒ¨ç½²çŠ¶æ€**ï¼šğŸŸ¢ å¯ä»¥éƒ¨ç½²
- **ç³»ç»Ÿç¨³å®šæ€§**ï¼šğŸŸ¢ é«˜
- **åŠŸèƒ½å®Œæ•´æ€§**ï¼šğŸŸ¢ å®Œæ•´
- **æµ‹è¯•è¦†ç›–åº¦**ï¼šğŸŸ¢ å…¨é¢

---

**ç‰ˆæœ¬**ï¼šv2.2.0  
**æ›´æ–°æ—¶é—´**ï¼š2025å¹´1æœˆ  
**ç»´æŠ¤å›¢é˜Ÿ**ï¼šæ™ºè¯Šé€šå¼€å‘å›¢é˜Ÿ  
**æ–‡æ¡£çŠ¶æ€**ï¼šå®Œæ•´ã€æ¸…æ™°ã€åˆç†ã€ä¸ä»£ç åŒæ­¥

*æœ¬æ–‡æ¡£å·²å®Œæˆæ•´åˆï¼ŒåŒ…å«äº†æ‰€æœ‰åŸæœ‰æ–‡æ¡£çš„å†…å®¹ï¼Œæä¾›äº†å®Œæ•´çš„ç³»ç»Ÿè¯´æ˜ï¼Œå¹¶ä¸å®é™…ä»£ç å®ç°ä¿æŒä¸€æ¯”ä¸€å¯¹åº”ã€‚æ•´åˆäº†æµå¼åŠŸèƒ½ã€ChromaDBè¿ç§»ã€é¡¹ç›®ç»“æ„ä¼˜åŒ–ç­‰æœ€æ–°æ›´æ–°å†…å®¹ã€‚*
